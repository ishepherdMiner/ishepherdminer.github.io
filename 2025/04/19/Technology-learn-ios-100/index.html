<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png">
  <link rel="mask-icon" href="/images/favicon.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Mach-OåŸºæœ¬ç»“æ„ Header: ï¼šæ–‡ä»¶ç±»å‹ã€ç›®æ ‡æ¶æ„ç±»å‹ç­‰ Load Commandsï¼šæè¿°æ–‡ä»¶åœ¨è™šæ‹Ÿå†…å­˜ä¸­çš„é€»è¾‘ç»“æ„ã€å¸ƒå±€ Data: åœ¨Load commandsä¸­å®šä¹‰çš„Segmentçš„æ•°æ®">
<meta property="og:type" content="article">
<meta property="og:title" content="iOS - Mach-O æ–‡ä»¶">
<meta property="og:url" content="http://yoursite.com/2025/04/19/Technology-learn-ios-100/index.html">
<meta property="og:site_name" content="ğŸ‘¨ğŸ»â€ğŸ’»&#39;s åšå®¢">
<meta property="og:description" content="Mach-OåŸºæœ¬ç»“æ„ Header: ï¼šæ–‡ä»¶ç±»å‹ã€ç›®æ ‡æ¶æ„ç±»å‹ç­‰ Load Commandsï¼šæè¿°æ–‡ä»¶åœ¨è™šæ‹Ÿå†…å­˜ä¸­çš„é€»è¾‘ç»“æ„ã€å¸ƒå±€ Data: åœ¨Load commandsä¸­å®šä¹‰çš„Segmentçš„æ•°æ®">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2025/04/19/TLE87QIb5oSaKB3.png">
<meta property="og:image" content="https://s2.loli.net/2025/04/19/Q4BeS8LYbTIHXuh.png">
<meta property="og:image" content="https://s2.loli.net/2025/04/19/KJBWPIrNT9ZRidg.png">
<meta property="og:image" content="https://s2.loli.net/2025/04/19/fPq83ZegOm2E5wH.png">
<meta property="og:image" content="https://s2.loli.net/2025/04/19/5S1t3mEMrvFBasN.png">
<meta property="og:image" content="https://s2.loli.net/2025/04/19/wWp6ovhcqBFTYQr.png">
<meta property="og:image" content="https://s2.loli.net/2025/04/19/G15OrZA2IyEFPBi.png">
<meta property="og:image" content="https://s2.loli.net/2025/04/19/XPoMs4k6w1IhJAc.png">
<meta property="og:image" content="https://s2.loli.net/2025/04/19/KFB1NRjTr25lekn.png">
<meta property="og:image" content="https://s2.loli.net/2025/04/19/TfH4rAGRv8Up2Zj.png">
<meta property="og:image" content="https://s2.loli.net/2025/04/19/QhX2JgYO195PZVy.png">
<meta property="og:image" content="https://s2.loli.net/2025/04/19/guhcKHyYbWRBx5U.png">
<meta property="og:image" content="https://s2.loli.net/2025/04/19/Kzy9EPSxIBfapeA.png">
<meta property="og:image" content="https://s2.loli.net/2025/04/19/PmZ6O3runkVtUMp.png">
<meta property="og:image" content="https://s2.loli.net/2025/04/19/ucV6ZNBCgvMKDE4.png">
<meta property="og:image" content="https://s2.loli.net/2025/04/19/1U7jcnMad52vCKf.png">
<meta property="og:image" content="https://s2.loli.net/2025/04/19/vu9yJSBRmCxKhQA.png">
<meta property="og:image" content="https://s2.loli.net/2025/04/19/xCLr2NaMA1UBbXO.png">
<meta property="og:image" content="https://s2.loli.net/2025/04/19/gRbIo76EOqMU4AW.png">
<meta property="og:image" content="https://s2.loli.net/2025/04/19/QvmLFjP9IafCWRM.png">
<meta property="og:image" content="https://s2.loli.net/2025/04/19/tsyDPgI5HTGeXFA.png">
<meta property="og:image" content="https://s2.loli.net/2025/04/19/De1YdSQF4bLNXcy.png">
<meta property="og:image" content="https://s2.loli.net/2025/04/19/KqL3vRz95yTplwD.png">
<meta property="og:image" content="https://s2.loli.net/2025/04/19/tNn4ORhPp3lHKTE.png">
<meta property="og:image" content="https://s2.loli.net/2025/04/19/lOYZIouvECmTdDr.png">
<meta property="og:image" content="https://s2.loli.net/2025/04/19/YiCavdxw8t7LGM3.png">
<meta property="og:image" content="https://s2.loli.net/2025/04/19/ap3ARMj51S4WDvq.png">
<meta property="article:published_time" content="2025-04-19T08:59:00.000Z">
<meta property="article:modified_time" content="2025-04-26T14:24:35.230Z">
<meta property="article:author" content="å¿˜å·ä¸‰">
<meta property="article:tag" content="Runtime">
<meta property="article:tag" content="Mechanism">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2025/04/19/TLE87QIb5oSaKB3.png">

<link rel="canonical" href="http://yoursite.com/2025/04/19/Technology-learn-ios-100/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>iOS - Mach-O æ–‡ä»¶ | ğŸ‘¨ğŸ»â€ğŸ’»'s åšå®¢</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">ğŸ‘¨ğŸ»â€ğŸ’»'s åšå®¢</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">æ…¢å“äººé—´çƒŸç«è‰²ï¼Œé—²è§‚ä¸‡äº‹å²æœˆé•¿</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2025/04/19/Technology-learn-ios-100/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="å¿˜å·ä¸‰">
      <meta itemprop="description" content="404~ ~ ~å°±å¤šèµ°ä¸€æ­¥">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ğŸ‘¨ğŸ»â€ğŸ’»'s åšå®¢">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          iOS - Mach-O æ–‡ä»¶
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2025-04-19 16:59:00" itemprop="dateCreated datePublished" datetime="2025-04-19T16:59:00+08:00">2025-04-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-04-26 22:24:35" itemprop="dateModified" datetime="2025-04-26T22:24:35+08:00">2025-04-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index"><span itemprop="name">iOS</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="Mach-OåŸºæœ¬ç»“æ„"><a href="#Mach-OåŸºæœ¬ç»“æ„" class="headerlink" title="Mach-OåŸºæœ¬ç»“æ„"></a>Mach-OåŸºæœ¬ç»“æ„</h2><ol>
<li>Header: ï¼šæ–‡ä»¶ç±»å‹ã€ç›®æ ‡æ¶æ„ç±»å‹ç­‰</li>
<li>Load Commandsï¼šæè¿°æ–‡ä»¶åœ¨è™šæ‹Ÿå†…å­˜ä¸­çš„é€»è¾‘ç»“æ„ã€å¸ƒå±€</li>
<li>Data: åœ¨Load commandsä¸­å®šä¹‰çš„Segmentçš„æ•°æ®</li>
</ol>
<span id="more"></span>

<p><img src="https://s2.loli.net/2025/04/19/TLE87QIb5oSaKB3.png" alt="2025-04-17 14.57.00.png"></p>
<h3 id="Header"><a href="#Header" class="headerlink" title="Header"></a>Header</h3><p><img src="https://s2.loli.net/2025/04/19/Q4BeS8LYbTIHXuh.png" alt="2025-04-17 14.59.03.png"></p>
<p>Headerçš„ç»“æ„å®šä¹‰åœ¨<code>loader.h</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * The 64-bit mach header appears at the very beginning of object files for</span></span><br><span class="line"><span class="comment"> * 64-bit architectures.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">mach_header_64</span> &#123;</span></span><br><span class="line">    <span class="comment">// é­”æ•°:64ä½çš„mach-oæœ‰ä¸¤ä¸ªå–å€¼</span></span><br><span class="line">    <span class="comment">// #define MH_MAGIC_64 0xfeedfacf -- å°ç«¯:Intel</span></span><br><span class="line">    <span class="comment">// #define MH_CIGAM_64 0xcffaedfe -- å¤§ç«¯:ä»¥å‰macOSåœ¨PowerPCå®‰è£…</span></span><br><span class="line">    <span class="type">uint32_t</span>	magic;		<span class="comment">/* mach magic number identifier */</span></span><br><span class="line">    <span class="comment">// cpuç±»å‹</span></span><br><span class="line">    <span class="comment">// åœ¨machine.hä¸­å®šä¹‰</span></span><br><span class="line">    <span class="comment">// ä¾‹å­ä¸­çš„æ˜¾ç¤ºçš„cpuçš„Valueæ˜¯:CPU_TYPE_ARM,æ ¹æ®ä¸‹é¢çš„å®šä¹‰ 0x0000000C | 0x01000000 = 0x0100000C</span></span><br><span class="line">    <span class="comment">// #define CPU_ARCH_ABI64          0x01000000      /* 64 bit ABI */</span></span><br><span class="line">    <span class="comment">// #define CPU_TYPE_ARM            ((cpu_type_t) 12)</span></span><br><span class="line">    <span class="comment">// #define CPU_TYPE_ARM64 (CPU_TYPE_ARM | CPU_ARCH_ABI64)</span></span><br><span class="line">    <span class="type">int32_t</span>		cputype;	<span class="comment">/* cpu specifier */</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     *  ARM64 subtypes</span></span><br><span class="line"><span class="comment">     *  ARM64çš„å…·ä½“ç±»å‹</span></span><br><span class="line"><span class="comment">     *  ä¾‹å­ä¸­çš„æ˜¾ç¤ºçš„å€¼æ˜¯0,å³CPU_SUBTYPE_ARM64_ALL</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">// #define CPU_SUBTYPE_ARM64_ALL           ((cpu_subtype_t) 0)</span></span><br><span class="line">    <span class="comment">// #define CPU_SUBTYPE_ARM64_V8            ((cpu_subtype_t) 1)</span></span><br><span class="line">    <span class="comment">// #define CPU_SUBTYPE_ARM64E              ((cpu_subtype_t) 2)</span></span><br><span class="line">    <span class="type">int32_t</span>		cpusubtype;	<span class="comment">/* machine specifier */</span></span><br><span class="line">    <span class="comment">// æ–‡ä»¶ç±»å‹</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * #define	MH_OBJECT	0x1 -- .oæ–‡ä»¶,.aæ˜¯.oçš„åˆé›†</span></span><br><span class="line"><span class="comment">     * #define	MH_EXECUTE	0x2 -- å¯æ‰§è¡Œæ–‡ä»¶</span></span><br><span class="line"><span class="comment">     * #define	MH_DYLIB	0x6 -- åŠ¨æ€åº“</span></span><br><span class="line"><span class="comment">     * #define	MH_DYLINKER	0x7 -- dyldé“¾æ¥å™¨</span></span><br><span class="line"><span class="comment">     * #define	MH_DSYM		0xa -- ç¬¦å·è¡¨æ–‡ä»¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">// ä¾‹å­ä¸­çš„æ˜¯2,å³MH_EXECUTE,å¯æ‰§è¡Œæ–‡ä»¶</span></span><br><span class="line">    <span class="type">uint32_t</span>	filetype;	<span class="comment">/* type of file */</span></span><br><span class="line">    <span class="comment">// Load CommandsåŠ è½½å‘½ä»¤çš„æ¡æ•°</span></span><br><span class="line">    <span class="comment">// ä¾‹å­ä¸­æ˜¯23æ¡</span></span><br><span class="line">    <span class="type">uint32_t</span>	ncmds;		<span class="comment">/* number of load commands */</span></span><br><span class="line">    <span class="comment">// Load Commandséƒ¨åˆ†çš„é•¿åº¦</span></span><br><span class="line">    <span class="comment">// ä¾‹å­ä¸­æ˜¯2864byte</span></span><br><span class="line">    <span class="type">uint32_t</span>	sizeofcmds;	<span class="comment">/* the size of all the load commands */</span></span><br><span class="line">    <span class="comment">// mach-oçš„æ ‡å¿—ï¼Œé€šè¿‡ä½ç§»æšä¸¾å®šä¹‰</span></span><br><span class="line">    <span class="comment">// ä¾‹å­ä¸­çš„</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * #define	 MH_NOUNDEFS	0x1 -- æ²¡æœ‰æœªå®šä¹‰çš„å¼•ç”¨</span></span><br><span class="line"><span class="comment">     * #define MH_DYLDLINK	0x4 -- å·²ç»é™æ€é“¾æ¥è¿‡äº†ï¼Œå¯ä»¥åŠ¨æ€é“¾æ¥</span></span><br><span class="line"><span class="comment">     * #define MH_TWOLEVEL	0x8 -- é“¾æ¥æ—¶:åº“å + å‡½æ•°å‡å°‘åŒåå†²çª è§å‚è€ƒä¸€</span></span><br><span class="line"><span class="comment">     * #define	MH_PIE 0x200000 -- æ¯æ¬¡åŠ è½½ä¸»ç¨‹åºåœ¨ä¸€ä¸ªéšæœºåœ°å€,å¢åŠ å®‰å…¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">uint32_t</span>	flags;		<span class="comment">/* flags */</span></span><br><span class="line">    <span class="comment">// ä¿ç•™</span></span><br><span class="line">    <span class="type">uint32_t</span>	reserved;	<span class="comment">/* reserved */</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Load-Commands"><a href="#Load-Commands" class="headerlink" title="Load Commands"></a>Load Commands</h2><p>æ¯ä¸ªLoad Commandséƒ½æœ‰å¯¹åº”çš„ç»“æ„ä½“</p>
<h3 id="LC-SEGMENT-64"><a href="#LC-SEGMENT-64" class="headerlink" title="LC_SEGMENT_64"></a>LC_SEGMENT_64</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * The 64-bit segment load command indicates that a part of this file is to be</span></span><br><span class="line"><span class="comment"> * mapped into a 64-bit task&#x27;s address space.  If the 64-bit segment has</span></span><br><span class="line"><span class="comment"> * sections then section_64 structures directly follow the 64-bit segment</span></span><br><span class="line"><span class="comment"> * command and their size is reflected in cmdsize.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">segment_command_64</span> &#123;</span> <span class="comment">/* for 64-bit architectures */</span></span><br><span class="line">	<span class="type">uint32_t</span>	cmd;		<span class="comment">/* LC_SEGMENT_64 */</span></span><br><span class="line">	<span class="type">uint32_t</span>	cmdsize;	<span class="comment">/* includes sizeof section_64 structs */</span></span><br><span class="line">	<span class="type">char</span>		segname[<span class="number">16</span>];	<span class="comment">/* segment name */</span></span><br><span class="line">	<span class="type">uint64_t</span>	vmaddr;		<span class="comment">/* memory address of this segment */</span></span><br><span class="line">	<span class="type">uint64_t</span>	vmsize;		<span class="comment">/* memory size of this segment */</span></span><br><span class="line">	<span class="type">uint64_t</span>	fileoff;	<span class="comment">/* file offset of this segment */</span></span><br><span class="line">	<span class="type">uint64_t</span>	filesize;	<span class="comment">/* amount to map from the file */</span></span><br><span class="line">	<span class="type">int32_t</span>  maxprot;	<span class="comment">/* maximum VM protection */</span></span><br><span class="line">	<span class="type">int32_t</span>	initprot;	<span class="comment">/* initial VM protection */</span></span><br><span class="line">	<span class="type">uint32_t</span>	nsects;		<span class="comment">/* number of sections in segment */</span></span><br><span class="line">	<span class="type">uint32_t</span>	flags;		<span class="comment">/* flags */</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="ä½¿ç”¨segment-command-64ç»“æ„ä½“çš„segment"><a href="#ä½¿ç”¨segment-command-64ç»“æ„ä½“çš„segment" class="headerlink" title="ä½¿ç”¨segment_command_64ç»“æ„ä½“çš„segment"></a>ä½¿ç”¨segment_command_64ç»“æ„ä½“çš„segment</h3><h4 id="Segment-PAGEZERO"><a href="#Segment-PAGEZERO" class="headerlink" title="Segment: __PAGEZERO"></a>Segment: __PAGEZERO</h4><p><code>__PAGEZERO</code>ç”¨äºæ•æ‰NULLæŒ‡é’ˆå¼•ç”¨</p>
<p><img src="https://s2.loli.net/2025/04/19/KJBWPIrNT9ZRidg.png" alt="2025-04-18 13.29.35.png"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> LC_SEGMENT_64 0x19 <span class="comment">// å³64ä½çš„segment</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// vm_prot.h</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">int</span>             <span class="type">vm_prot_t</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> VM_PROT_NONE    ((vm_prot_t) 0x00)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯»/å†™/æ‰§è¡Œ</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> VM_PROT_READ    ((vm_prot_t) 0x01)      <span class="comment">/* read permission */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> VM_PROT_WRITE   ((vm_prot_t) 0x02)      <span class="comment">/* write permission */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> VM_PROT_EXECUTE ((vm_prot_t) 0x04)      <span class="comment">/* execute permission */</span></span></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>å˜é‡å</th>
<th>å€¼</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>cmd</td>
<td>0x19</td>
<td>segmentçš„ç±»å‹</td>
</tr>
<tr>
<td>cmdsize</td>
<td>0x48</td>
<td>segmentçš„é•¿åº¦, è¿™é‡Œæ˜¯0x48 = 0x000000068 - 0x00000020</td>
</tr>
<tr>
<td>segname</td>
<td>0x5F5F504147455A45524F000000000000</td>
<td>segmentçš„å,è¿™é‡Œæ˜¯__PAGEZERO, ASCIIè¡¨ç¤º:5F = â€˜_â€™,50 = â€˜Pâ€™,41 = â€˜Aâ€™â€¦,4F = â€˜Oâ€™</td>
</tr>
<tr>
<td>vmaddr</td>
<td>0</td>
<td>segmentåœ¨è™šæ‹Ÿå†…å­˜çš„èµ·å§‹åœ°å€,8ä¸ªå­—èŠ‚uint64_t</td>
</tr>
<tr>
<td>vmsize</td>
<td>0x0000000100000000</td>
<td>segmentçš„é•¿åº¦,2^32 = 4GB,å³64ä½çš„è™šæ‹Ÿå†…å­˜çš„å‰4Géƒ½æ˜¯__PAGEZERO</td>
</tr>
<tr>
<td>fileoff</td>
<td>0</td>
<td>æ–‡ä»¶çš„åç§»é‡,ä»ç£ç›˜çš„è§’åº¦çœ‹</td>
</tr>
<tr>
<td>filesize</td>
<td>0</td>
<td>å ç”¨æ–‡ä»¶çš„å¤§å°,è¿™æ˜¯ç£ç›˜çš„è§’åº¦çœ‹,å®é™…æœªå ç”¨ç£ç›˜å¤§å°</td>
</tr>
<tr>
<td>maxprot</td>
<td>0</td>
<td>è™šæ‹Ÿå†…å­˜çš„æœ€é«˜çš„æƒé™è®¾ç½®,æœªè®¾ç½®,å³ä¸èƒ½è¯»,ä¸èƒ½å†™,ä¹Ÿä¸èƒ½è¢«åŠ è½½åˆ°cpuä¸­æ‰§è¡Œ</td>
</tr>
<tr>
<td>initprot</td>
<td>0</td>
<td>åˆå§‹åŒ–æ—¶çš„è™šæ‹Ÿå†…å­˜çš„æƒé™è®¾ç½®,æœªè®¾ç½®</td>
</tr>
<tr>
<td>nsects</td>
<td>0</td>
<td>segmentä¸­åŒ…å«çš„sectionçš„æ•°é‡ï¼Œè¿™é‡Œä¸º0ä¸ª</td>
</tr>
<tr>
<td>flags</td>
<td>0</td>
<td>æ ‡å¿—,æ²¡æœ‰</td>
</tr>
</tbody></table>
<h4 id="Segment-TEXT-ä»£ç "><a href="#Segment-TEXT-ä»£ç " class="headerlink" title="Segment: __TEXT ä»£ç "></a>Segment: __TEXT ä»£ç </h4><p><code>__TEXT</code>ç”¨äºæè¿°ä»£ç segmentçš„ä¸€äº›ä¿¡æ¯</p>
<p><img src="https://s2.loli.net/2025/04/19/fPq83ZegOm2E5wH.png" alt="2025-04-18 13.59.07.png"></p>
<p>ä¹Ÿæ˜¯segment_command_64ç»“æ„ä½“,å¯ä»¥çœ‹åˆ°è¿™ä¸ªsegmentä¸­çš„initprotä¸­æ˜¯æœ‰VM_PROT_EXECUTEï¼Œå£°æ˜è¿™éƒ¨åˆ†æ˜¯å¯ä»¥è¢«æ‰§è¡Œçš„ã€‚segmentä¸­9ä¸ªsections</p>
<h5 id="Section-text"><a href="#Section-text" class="headerlink" title="Section: __text"></a>Section: __text</h5><p>æ¯ä¸ªsectionçš„ç»“æ„ä½“å¦‚ä¸‹</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">section_64</span> &#123;</span> <span class="comment">/* for 64-bit architectures */</span></span><br><span class="line">	<span class="type">char</span>		sectname[<span class="number">16</span>];	<span class="comment">/* name of this section */</span></span><br><span class="line">	<span class="type">char</span>		segname[<span class="number">16</span>];	<span class="comment">/* segment this section goes in */</span></span><br><span class="line">	<span class="type">uint64_t</span>	addr;		<span class="comment">/* memory address of this section */</span></span><br><span class="line">	<span class="type">uint64_t</span>	size;		<span class="comment">/* size in bytes of this section */</span></span><br><span class="line">	<span class="type">uint32_t</span>	offset;		<span class="comment">/* file offset of this section */</span></span><br><span class="line">	<span class="type">uint32_t</span>	align;		<span class="comment">/* section alignment (power of 2) */</span></span><br><span class="line">	<span class="type">uint32_t</span>	reloff;		<span class="comment">/* file offset of relocation entries */</span></span><br><span class="line">	<span class="type">uint32_t</span>	nreloc;		<span class="comment">/* number of relocation entries */</span></span><br><span class="line">	<span class="type">uint32_t</span>	flags;		<span class="comment">/* flags (section type and attributes)*/</span></span><br><span class="line">	<span class="type">uint32_t</span>	reserved1;	<span class="comment">/* reserved (for offset or index) */</span></span><br><span class="line">	<span class="type">uint32_t</span>	reserved2;	<span class="comment">/* reserved (for count or sizeof) */</span></span><br><span class="line">	<span class="type">uint32_t</span>	reserved3;	<span class="comment">/* reserved */</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2025/04/19/5S1t3mEMrvFBasN.png" alt="2025-04-18 14.12.42.png"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span>	S_REGULAR		0x0	<span class="comment">/* regular section */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> S_ATTR_PURE_INSTRUCTIONS 0x80000000 <span class="comment">// è¿™ä¸ªsectionsåªåŒ…å«æœºå™¨æŒ‡ä»¤</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> S_ATTR_SOME_INSTRUCTIONS 0x00000400	<span class="comment">/* section contains some</span></span></span><br><span class="line"><span class="comment"><span class="meta">						   machine instructions */</span></span></span><br></pre></td></tr></table></figure>


<table>
<thead>
<tr>
<th>å˜é‡å</th>
<th>å€¼</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>sectname</td>
<td>0x5F5F7465787400000000000000000000</td>
<td>sectionçš„åç§°,__text</td>
</tr>
<tr>
<td>segname</td>
<td>0x5F5F5445585400000000000000000000</td>
<td>sectionæ‰€å±segmentçš„åç§°,__TEXT</td>
</tr>
<tr>
<td>addr</td>
<td>0x0000000100005F04</td>
<td>è™šæ‹Ÿå†…å­˜çš„èµ·å§‹åœ°å€</td>
</tr>
<tr>
<td>size</td>
<td>0x0000000000000564</td>
<td>sectionçš„é•¿åº¦</td>
</tr>
<tr>
<td>offset</td>
<td>0x5F04</td>
<td>ä»£ç åœ¨æ–‡ä»¶çš„å…·ä½“åç§»é‡ï¼Œæ¯ä¸ªåº”ç”¨éƒ½ä¸ä¸€æ ·</td>
</tr>
<tr>
<td>align</td>
<td>4</td>
<td>å¯¹é½</td>
</tr>
<tr>
<td>reloff</td>
<td>0</td>
<td>é™æ€é“¾æ¥é‡å®šä½,.aæ–‡ä»¶ä¸­__objc_constèƒ½çœ‹åˆ°</td>
</tr>
<tr>
<td>nreloc</td>
<td>0</td>
<td>é™æ€é“¾æ¥é‡å®šä½çš„ç¬¦å·çš„æ•°é‡</td>
</tr>
<tr>
<td>flags</td>
<td>0x80000400</td>
<td>æ ‡å¿—ï¼Œè¯¦è§loader.h</td>
</tr>
<tr>
<td>reserved1</td>
<td></td>
<td>ä¿ç•™ï¼ŒåŠ¨æ€é“¾æ¥æ—¶çš„ç¬¦å·</td>
</tr>
<tr>
<td>reserved2</td>
<td></td>
<td>ä¿ç•™ï¼ŒåŠ¨æ€é“¾æ¥æ—¶çš„ç¬¦å·æ•°é‡</td>
</tr>
<tr>
<td>reserved3</td>
<td></td>
<td>ä¿ç•™</td>
</tr>
</tbody></table>
<p><img src="https://s2.loli.net/2025/04/19/wWp6ovhcqBFTYQr.png" alt="2025-04-18 14.29.09.png"></p>
<p>ç„¶åå› ä¸º<code>__PAGEZERO</code>å ç”¨äº†<code>0x0000000100000000</code> åŠ ä¸Šå‰é¢æ–‡ä»¶å ç”¨äº†ç©ºé—´,æ‰€ä»¥åº”ç”¨çš„æ±‡ç¼–ä»£ç çš„èµ·å§‹ä½ç½®åœ¨<code>0x5F04</code>ä½ç½®ï¼Œä»ä¸Šé¢çš„æˆªå›¾çœ‹ç¡®å®å¦‚æ­¤</p>
<h5 id="Section-stubs"><a href="#Section-stubs" class="headerlink" title="Section: __stubs"></a>Section: __stubs</h5><p>åŠ¨æ€é“¾æ¥çš„ç¬¦å·,çœ‹reserved2æœ‰12ä¸ª,è¿™éƒ¨åˆ†åœ¨äºŒè¿›åˆ¶ä¸­çš„åœ°å€æ˜¯<code>0x0000000100006468</code></p>
<p><img src="https://s2.loli.net/2025/04/19/G15OrZA2IyEFPBi.png" alt="2025-04-18 15.19.43.png"></p>
<p>åˆ°<code>0x0000000100006468</code>æŸ¥çœ‹</p>
<p><img src="https://s2.loli.net/2025/04/19/XPoMs4k6w1IhJAc.png" alt="2025-04-18 15.21.09.png"></p>
<p>è¿™é‡Œå­˜æ”¾çš„æ˜¯è¿è¡Œæ—¶éœ€è¦ä»ç³»ç»Ÿå’Œå…¶ä»–åŠ¨æ€åº“ä¸­åŠ è½½çš„ç¬¦å·</p>
<h5 id="Section-stub-helper"><a href="#Section-stub-helper" class="headerlink" title="Section: __stub_helper"></a>Section: __stub_helper</h5><p>åŠ è½½åŠ¨æ€åº“æœ‰rebindingç¬¦å·çš„è¿‡ç¨‹,æ¯”å¦‚ä¸Šé¢<code>__stub</code>çš„éœ€è¦12ä¸ªå¤–éƒ¨çš„ç¬¦å·,<code>__stub_helper</code>æ˜¯è¾…åŠ©è¯¥è¿‡ç¨‹èƒ½é¡ºåˆ©å®Œæˆ</p>
<h5 id="Section-objc-stubs"><a href="#Section-objc-stubs" class="headerlink" title="Section: __objc_stubs"></a>Section: __objc_stubs</h5><blockquote>
<p>__objc_stubs is a section in iOS binaries that contains stub functions for Objective-C calls. These stubs are used for debugging and analyzing Objective-C code</p>
</blockquote>
<blockquote>
<p>iOS Apps compiled with recent versions of XCode can generate stubs for msgSend calls, where each stub is just a call to the actual msgSend address after setting a specific selector:</p>
</blockquote>
<p>åº”è¯¥æ˜¯ä¸ªé«˜ç‰ˆæœ¬SDKè·³è¿‡æ¶ˆæ¯æŸ¥æ‰¾è¿‡ç¨‹,åŠ å¿«æ–¹æ³•è°ƒç”¨çš„ä¼˜åŒ–ï¼Œåé¢å†æ¢ç©¶ã€‚</p>
<h5 id="Section-objc-methods"><a href="#Section-objc-methods" class="headerlink" title="Section: __objc_methods"></a>Section: __objc_methods</h5><p>OCæ–¹æ³•çš„ä¿¡æ¯</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span>	S_CSTRING_LITERALS	0x2	<span class="comment">/* section with only literal C strings*/</span> <span class="comment">// sectionsé‡Œåªæœ‰Cè¯­è¨€çš„å¸¸é‡å­—ç¬¦ä¸²</span></span></span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2025/04/19/KFB1NRjTr25lekn.png" alt="2025-04-18 15.58.12.png"></p>
<h5 id="Section-objc-classname"><a href="#Section-objc-classname" class="headerlink" title="Section:__objc_classname"></a>Section:__objc_classname</h5><p>OCçš„ç±»åç›¸å…³çš„æè¿°,å’Œ<code>__objc_methods</code>å·®ä¸å¤š</p>
<h5 id="Section-objc-methtype"><a href="#Section-objc-methtype" class="headerlink" title="Section:__objc_methtype"></a>Section:__objc_methtype</h5><p>OCçš„æ–¹æ³•ç­¾åéƒ¨åˆ†çš„æè¿°</p>
<p>æ‰¾åˆ°Dataéƒ¨åˆ†å®é™…å­˜çš„å†…å®¹</p>
<p><img src="https://s2.loli.net/2025/04/19/TfH4rAGRv8Up2Zj.png" alt="2025-04-19 16.25.52.png"></p>
<h5 id="Section-cstring"><a href="#Section-cstring" class="headerlink" title="Section: __cstring"></a>Section: __cstring</h5><p>Cçš„å¸¸é‡å­—ç¬¦ä¸²çš„æè¿°</p>
<h5 id="Section-unwind-info"><a href="#Section-unwind-info" class="headerlink" title="Section: __unwind_info"></a>Section: __unwind_info</h5><p>ç”¨äºå­˜å‚¨å¤„ç†å¼‚å¸¸æƒ…å†µçš„ä¿¡æ¯</p>
<h4 id="Segment-DATA-æ•°æ®"><a href="#Segment-DATA-æ•°æ®" class="headerlink" title="Segment: __DATA æ•°æ®"></a>Segment: __DATA æ•°æ®</h4><p>å¯¹æ•°æ®éƒ¨åˆ†çš„ç»„ç»‡è§„åˆ™çš„æè¿°,è¿™éƒ¨åˆ†ä¹Ÿæœ‰ä¸€äº›sections</p>
<h5 id="Section-got"><a href="#Section-got" class="headerlink" title="Section: __got"></a>Section: __got</h5><p>éæ‡’åŠ è½½æŒ‡é’ˆï¼Œdyld åŠ è½½æ—¶ä¼šç«‹å³ç»‘å®šè¡¨é¡¹ä¸­çš„ç¬¦å·</p>
<p><img src="https://s2.loli.net/2025/04/19/QhX2JgYO195PZVy.png" alt="2025-04-18 17.39.32.png"></p>
<p>dyld_stub_binder è´Ÿè´£ç»‘å®šç¬¦å·,objc_msgSendæ¶ˆæ¯å‘é€,è¿™ä¸¤ä¸ªæ‡’åŠ è½½æ²¡æœ‰æ„ä¹‰</p>
<h5 id="Seciton-la-symbol-ptr"><a href="#Seciton-la-symbol-ptr" class="headerlink" title="Seciton: __la_symbol_ptr"></a>Seciton: __la_symbol_ptr</h5><p>ç›¸å¯¹çš„æ˜¯æ‡’åŠ è½½æŒ‡é’ˆï¼Œè¡¨ä¸­çš„æŒ‡é’ˆä¸€å¼€å§‹éƒ½æŒ‡å‘ __TEXT.__stub_helper</p>
<h5 id="Section-cfstring"><a href="#Section-cfstring" class="headerlink" title="Section: __cfstring"></a>Section: __cfstring</h5><p>Core Foundation å­—ç¬¦ä¸²</p>
<h5 id="Section-objc-classlist"><a href="#Section-objc-classlist" class="headerlink" title="Section: __objc_classlist"></a>Section: __objc_classlist</h5><p>è®°å½•äº†Appä¸­æ‰€æœ‰çš„classï¼ŒåŒ…æ‹¬meta classã€‚è¯¥èŠ‚ä¸­å­˜å‚¨çš„æ˜¯ä¸€ä¸ªä¸ªçš„æŒ‡é’ˆï¼ŒæŒ‡é’ˆæŒ‡å‘çš„åœ°å€æ˜¯classç»“æ„ä½“æ‰€åœ¨çš„åœ°å€</p>
<p><img src="https://s2.loli.net/2025/04/19/guhcKHyYbWRBx5U.png" alt="2025-04-18 20.40.30.png"></p>
<p>è¿™é‡ŒAddressæ˜¯<code>0x100008090</code>,å»æ‰å‰é¢çš„<code>0x100000000</code>(__PAGEZERO),æ‰¾<code>0x8090</code>çš„åœ°å€</p>
<p><img src="https://s2.loli.net/2025/04/19/Kzy9EPSxIBfapeA.png" alt="2025-04-18 20.41.38.png"></p>
<p>é‡Œé¢çš„å€¼æ˜¯<code>0x00000001000091A0</code>,æè¿°æ˜¯æŒ‡é’ˆï¼Œå†å»æ‰¾<code>0x91A0</code>,èµ°åˆ°<code>__DATA.__objc_data</code>ï¼Œè¿™é‡Œå­˜ç€å®é™…çš„OCçš„ç±»</p>
<p><img src="https://s2.loli.net/2025/04/19/PmZ6O3runkVtUMp.png" alt="2025-04-18 20.49.16.png"></p>
<h5 id="Section-objc-protolist"><a href="#Section-objc-protolist" class="headerlink" title="Section: __objc_protolist"></a>Section: __objc_protolist</h5><p><img src="https://s2.loli.net/2025/04/19/ucV6ZNBCgvMKDE4.png" alt="2025-04-18 21.00.38.png"></p>
<p>0x1000080A8 =&gt; 0x0000000100009298,åˆ°äº† <code>__DATA.__data</code>ï¼Ÿ</p>
<p><img src="https://s2.loli.net/2025/04/19/1U7jcnMad52vCKf.png" alt="2025-04-18 21.00.48.png"></p>
<p><img src="https://s2.loli.net/2025/04/19/vu9yJSBRmCxKhQA.png" alt="2025-04-18 21.03.23.png"></p>
<h5 id="Section-objc-imageInfo"><a href="#Section-objc-imageInfo" class="headerlink" title="Section: __objc_imageInfo"></a>Section: __objc_imageInfo</h5><p>ä¸»è¦ç”¨æ¥åŒºåˆ†OCçš„ç‰ˆæœ¬æ˜¯ 1.0 è¿˜æ˜¯ 2.0</p>
<h5 id="Section-objc-const"><a href="#Section-objc-const" class="headerlink" title="Section: __objc_const"></a>Section: __objc_const</h5><p>è®°å½•åœ¨OCå†…å­˜åˆå§‹åŒ–è¿‡ç¨‹ä¸­çš„ä¸å¯å˜å†…å®¹ï¼Œæ¯”å¦‚ method_t ç»“æ„ä½“å®šä¹‰</p>
<h5 id="Section-objc-selrefs"><a href="#Section-objc-selrefs" class="headerlink" title="Section: __objc_selrefs"></a>Section: __objc_selrefs</h5><p>æ ‡è®°å“ªäº›SELå¯¹åº”çš„å­—ç¬¦ä¸²è¢«å¼•ç”¨äº†</p>
<h5 id="Section-objc-classrefs"><a href="#Section-objc-classrefs" class="headerlink" title="Section: __objc_classrefs"></a>Section: __objc_classrefs</h5><p>æ ‡è®°å“ªäº›ç±»è¢«å¼•ç”¨äº†</p>
<h5 id="Section-objc-superrefs"><a href="#Section-objc-superrefs" class="headerlink" title="Section: __objc_superrefs"></a>Section: __objc_superrefs</h5><p>Objective-C è¶…ç±»å¼•ç”¨</p>
<h5 id="Section-objc-ivar"><a href="#Section-objc-ivar" class="headerlink" title="Section: __objc_ivar"></a>Section: __objc_ivar</h5><p>å­˜å‚¨ç¨‹åºä¸­çš„ ivar å˜é‡</p>
<h5 id="Section-objc-data"><a href="#Section-objc-data" class="headerlink" title="Section: __objc_data"></a>Section: __objc_data</h5><p>ç”¨äºä¿å­˜ OC ç±»éœ€è¦çš„æ•°æ®ã€‚æœ€ä¸»è¦çš„å†…å®¹æ˜¯æ˜ å°„ __objc_const åœ°å€ï¼Œç”¨äºæ‰¾åˆ°ç±»çš„ç›¸å…³æ•°æ®</p>
<h5 id="Section-data"><a href="#Section-data" class="headerlink" title="Section: __data"></a>Section: __data</h5><p>åˆå§‹åŒ–è¿‡çš„å¯å˜æ•°æ®</p>
<h4 id="Segment-LINKEDIT"><a href="#Segment-LINKEDIT" class="headerlink" title="Segment: __LINKEDIT"></a>Segment: __LINKEDIT</h4><p><img src="https://s2.loli.net/2025/04/19/xCLr2NaMA1UBbXO.png" alt="16.23.03"></p>
<p>fileOffsetæ˜¯ 0xc000,sizeæ˜¯0x7850ï¼Œä¸¤è€…ç›¸åŠ å¾— 0x13850ï¼Œä»ä¸‹å›¾å¯çŸ¥Dynamic Loader Info åˆ°Code Signatureéƒ½æ˜¯è¿™ä¸ªåŒºé—´å†…,é‡Œé¢åŒ…å«åŠ¨æ€åº“åŠ è½½å“ªäº›ç¬¦å·ï¼Œç¬¦å·è¡¨ï¼ŒäºŒè¿›åˆ¶çš„ç­¾åä¿¡æ¯ã€‚æ‰€ä»¥å¯æ‰§è¡Œæ–‡ä»¶çš„åŠ è½½æŒ‡ä»¤åçš„å®é™…å†…å®¹å°±æ˜¯__TEXT,__DATA,__LINKEDITï¼Œ__PAGEZEROæ˜¯å ä½</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç”¨sizeå‘½ä»¤æ˜¾ç¤ºmachoæ–‡ä»¶æ—¶å°±æ˜¯4ä¸ªæ®µ</span></span><br><span class="line">$ size -x -m path/to/macho-execute</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2025/04/19/gRbIo76EOqMU4AW.png" alt="2025-04-18 18.24.32.png"></p>
<p><img src="https://s2.loli.net/2025/04/19/QvmLFjP9IafCWRM.png" alt="2025-04-18 16.26.29.png"></p>
<p><img src="https://s2.loli.net/2025/04/19/tsyDPgI5HTGeXFA.png" alt="2025-04-18 16.28.03.png"></p>
<h3 id="ä½¿ç”¨å…¶ä»–ç»“æ„ä½“çš„Command"><a href="#ä½¿ç”¨å…¶ä»–ç»“æ„ä½“çš„Command" class="headerlink" title="ä½¿ç”¨å…¶ä»–ç»“æ„ä½“çš„Command"></a>ä½¿ç”¨å…¶ä»–ç»“æ„ä½“çš„Command</h3><h4 id="Command-LC-DYLD-INFO-ONLY"><a href="#Command-LC-DYLD-INFO-ONLY" class="headerlink" title="Command:LC_DYLD_INFO_ONLY"></a>Command:LC_DYLD_INFO_ONLY</h4><p>æè¿°dyldè¦ç»‘å®šåŠ¨æ€åº“çš„å“ªäº›ç¬¦å·,æ˜¯å¼ºç»‘å®šè¿˜æ˜¯å¼±ç»‘å®š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * The dyld_info_command contains the file offsets and sizes of </span></span><br><span class="line"><span class="comment"> * the new compressed form of the information dyld needs to </span></span><br><span class="line"><span class="comment"> * load the image.  This information is used by dyld on Mac OS X</span></span><br><span class="line"><span class="comment"> * 10.6 and later.  All information pointed to by this command</span></span><br><span class="line"><span class="comment"> * is encoded using byte streams, so no endian swapping is needed</span></span><br><span class="line"><span class="comment"> * to interpret it. </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">dyld_info_command</span> &#123;</span></span><br><span class="line">    <span class="type">uint32_t</span>   cmd;		<span class="comment">/* LC_DYLD_INFO or LC_DYLD_INFO_ONLY */</span></span><br><span class="line">    <span class="type">uint32_t</span>   cmdsize;		<span class="comment">/* sizeof(struct dyld_info_command) */</span></span><br><span class="line">    <span class="type">uint32_t</span>   rebase_off;	<span class="comment">/* file offset to rebase info  */</span></span><br><span class="line">    <span class="type">uint32_t</span>   rebase_size;	<span class="comment">/* size of rebase info   */</span></span><br><span class="line">    <span class="type">uint32_t</span>   bind_off;	<span class="comment">/* file offset to binding info   */</span></span><br><span class="line">    <span class="type">uint32_t</span>   bind_size;	<span class="comment">/* size of binding info  */</span></span><br><span class="line">    <span class="type">uint32_t</span>   weak_bind_off;</span><br><span class="line">    <span class="type">uint32_t</span>   weak_bind_size;  <span class="comment">/* size of weak binding info  */</span></span><br><span class="line">    <span class="type">uint32_t</span>   lazy_bind_off;</span><br><span class="line">    <span class="type">uint32_t</span>   lazy_bind_size;  <span class="comment">/* size of lazy binding infs */</span></span><br><span class="line">    <span class="type">uint32_t</span>   export_off;	<span class="comment">/* file offset to lazy binding info */</span></span><br><span class="line">    <span class="type">uint32_t</span>   export_size;	<span class="comment">/* size of lazy binding infs */</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="Command-LC-SYMTAB"><a href="#Command-LC-SYMTAB" class="headerlink" title="Command: LC_SYMTAB"></a>Command: LC_SYMTAB</h4><p>machoæ–‡ä»¶çš„ç¬¦å·è¡¨çš„æè¿°</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * The symtab_command contains the offsets and sizes of the link-edit 4.3BSD</span></span><br><span class="line"><span class="comment"> * &quot;stab&quot; style symbol table information as described in the header files</span></span><br><span class="line"><span class="comment"> * &lt;nlist.h&gt; and &lt;stab.h&gt;.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">symtab_command</span> &#123;</span></span><br><span class="line">	<span class="type">uint32_t</span>	cmd;		<span class="comment">/* LC_SYMTAB */</span></span><br><span class="line">	<span class="type">uint32_t</span>	cmdsize;	<span class="comment">/* sizeof(struct symtab_command) */</span></span><br><span class="line">	<span class="type">uint32_t</span>	symoff;		<span class="comment">/* symbol table offset */</span></span><br><span class="line">	<span class="type">uint32_t</span>	nsyms;		<span class="comment">/* number of symbol table entries */</span></span><br><span class="line">	<span class="type">uint32_t</span>	stroff;		<span class="comment">/* string table offset */</span></span><br><span class="line">	<span class="type">uint32_t</span>	strsize;	<span class="comment">/* string table size in bytes */</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="Command-LC-DYSYMTAB"><a href="#Command-LC-DYSYMTAB" class="headerlink" title="Command: LC_DYSYMTAB"></a>Command: LC_DYSYMTAB</h4><p>machoæ–‡ä»¶ä¾èµ–çš„åŠ¨æ€åº“çš„ç¬¦å·è¡¨</p>
<h4 id="Command-LC-LOAD-DYLINKER"><a href="#Command-LC-LOAD-DYLINKER" class="headerlink" title="Command: LC_LOAD_DYLINKER"></a>Command: LC_LOAD_DYLINKER</h4><p>åŠ è½½dyldé“¾æ¥å™¨</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * A program that uses a dynamic linker contains a dylinker_command to identify</span></span><br><span class="line"><span class="comment"> * the name of the dynamic linker (LC_LOAD_DYLINKER).  And a dynamic linker</span></span><br><span class="line"><span class="comment"> * contains a dylinker_command to identify the dynamic linker (LC_ID_DYLINKER).</span></span><br><span class="line"><span class="comment"> * A file can have at most one of these.</span></span><br><span class="line"><span class="comment"> * This struct is also used for the LC_DYLD_ENVIRONMENT load command and</span></span><br><span class="line"><span class="comment"> * contains string for dyld to treat like environment variable.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">dylinker_command</span> &#123;</span></span><br><span class="line">	<span class="type">uint32_t</span>	cmd;		<span class="comment">/* LC_ID_DYLINKER, LC_LOAD_DYLINKER or</span></span><br><span class="line"><span class="comment">					   LC_DYLD_ENVIRONMENT */</span></span><br><span class="line">	<span class="type">uint32_t</span>	cmdsize;	<span class="comment">/* includes pathname string */</span></span><br><span class="line">	<span class="class"><span class="keyword">union</span> <span class="title">lc_str</span>    <span class="title">name</span>;</span>		<span class="comment">/* dynamic linker&#x27;s path name */</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2025/04/19/De1YdSQF4bLNXcy.png" alt="2025-04-18 16.41.23.png"></p>
<h4 id="Command-LC-UUID"><a href="#Command-LC-UUID" class="headerlink" title="Command: LC_UUID"></a>Command: LC_UUID</h4><p>é™æ€è¿æ¥å™¨ç”Ÿæˆçš„128ä½éšæœºæ•°,ç”¨äºæ ‡è¯†machoæ–‡ä»¶</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * The uuid load command contains a single 128-bit unique random number that</span></span><br><span class="line"><span class="comment"> * identifies an object produced by the static link editor.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">uuid_command</span> &#123;</span></span><br><span class="line">    <span class="type">uint32_t</span>	cmd;		<span class="comment">/* LC_UUID */</span></span><br><span class="line">    <span class="type">uint32_t</span>	cmdsize;	<span class="comment">/* sizeof(struct uuid_command) */</span></span><br><span class="line">    <span class="type">uint8_t</span>	uuid[<span class="number">16</span>];	<span class="comment">/* the 128-bit uuid */</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="Command-LC-VERSION-MIN-IPHONEOS"><a href="#Command-LC-VERSION-MIN-IPHONEOS" class="headerlink" title="Command: LC_VERSION_MIN_IPHONEOS"></a>Command: LC_VERSION_MIN_IPHONEOS</h4><p>æŒ‡å®šæœ€ä½ç‰ˆæœ¬å·</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * The version_min_command contains the min OS version on which this </span></span><br><span class="line"><span class="comment"> * binary was built to run.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">version_min_command</span> &#123;</span></span><br><span class="line">    <span class="type">uint32_t</span>	cmd;		<span class="comment">/* LC_VERSION_MIN_MACOSX or</span></span><br><span class="line"><span class="comment">				   LC_VERSION_MIN_IPHONEOS or</span></span><br><span class="line"><span class="comment">				   LC_VERSION_MIN_WATCHOS or</span></span><br><span class="line"><span class="comment">				   LC_VERSION_MIN_TVOS */</span></span><br><span class="line">    <span class="type">uint32_t</span>	cmdsize;	<span class="comment">/* sizeof(struct min_version_command) */</span></span><br><span class="line">    <span class="type">uint32_t</span>	version;	<span class="comment">/* X.Y.Z is encoded in nibbles xxxx.yy.zz */</span></span><br><span class="line">    <span class="type">uint32_t</span>	sdk;		<span class="comment">/* X.Y.Z is encoded in nibbles xxxx.yy.zz */</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="Command-LC-SOURCE-VERSION"><a href="#Command-LC-SOURCE-VERSION" class="headerlink" title="Command: LC_SOURCE_VERSION"></a>Command: LC_SOURCE_VERSION</h4><p>æŒ‡å®šiOS SDKç³»ç»Ÿåº“çš„ç‰ˆæœ¬</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * The source_version_command is an optional load command containing</span></span><br><span class="line"><span class="comment"> * the version of the sources used to build the binary.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">source_version_command</span> &#123;</span></span><br><span class="line">    <span class="type">uint32_t</span>  cmd;	<span class="comment">/* LC_SOURCE_VERSION */</span></span><br><span class="line">    <span class="type">uint32_t</span>  cmdsize;	<span class="comment">/* 16 */</span></span><br><span class="line">    <span class="type">uint64_t</span>  version;	<span class="comment">/* A.B.C.D.E packed as a24.b10.c10.d10.e10 */</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="Command-LC-MAIN"><a href="#Command-LC-MAIN" class="headerlink" title="Command: LC_MAIN"></a>Command: LC_MAIN</h4><p>åº”ç”¨ç¨‹åºå…¥å£</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * The entry_point_command is a replacement for thread_command.</span></span><br><span class="line"><span class="comment"> * It is used for main executables to specify the location (file offset)</span></span><br><span class="line"><span class="comment"> * of main().  If -stack_size was used at link time, the stacksize</span></span><br><span class="line"><span class="comment"> * field will contain the stack size need for the main thread.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">entry_point_command</span> &#123;</span></span><br><span class="line">    <span class="type">uint32_t</span>  cmd;	<span class="comment">/* LC_MAIN only used in MH_EXECUTE filetypes */</span></span><br><span class="line">    <span class="type">uint32_t</span>  cmdsize;	<span class="comment">/* 24 */</span></span><br><span class="line">    <span class="type">uint64_t</span>  entryoff;	<span class="comment">/* file (__TEXT) offset of main() */</span></span><br><span class="line">    <span class="type">uint64_t</span>  stacksize;<span class="comment">/* if not zero, initial stack size */</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2025/04/19/KqL3vRz95yTplwD.png" alt="2025-04-18 16.52.55.png"></p>
<p>åœ°å€æ˜¯ 0x6120ï¼Œæ‰¾åˆ°å¯¹åº”åœ°å€å¯çŸ¥å°±æ˜¯ <code>_main</code>å‡½æ•°çš„åœ°å€</p>
<p><img src="https://s2.loli.net/2025/04/19/tNn4ORhPp3lHKTE.png" alt="2025-04-18 16.53.19.png"></p>
<h4 id="Command-LC-ENCRYPTION-INFO-64"><a href="#Command-LC-ENCRYPTION-INFO-64" class="headerlink" title="Command: LC_ENCRYPTION_INFO_64"></a>Command: LC_ENCRYPTION_INFO_64</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * The encryption_info_command contains the file offset and size of an</span></span><br><span class="line"><span class="comment"> * of an encrypted segment.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">encryption_info_command</span> &#123;</span></span><br><span class="line">   <span class="type">uint32_t</span>	cmd;		<span class="comment">/* LC_ENCRYPTION_INFO */</span></span><br><span class="line">   <span class="type">uint32_t</span>	cmdsize;	<span class="comment">/* sizeof(struct encryption_info_command) */</span></span><br><span class="line">   <span class="type">uint32_t</span>	cryptoff;	<span class="comment">/* file offset of encrypted range */</span></span><br><span class="line">   <span class="type">uint32_t</span>	cryptsize;	<span class="comment">/* file size of encrypted range */</span></span><br><span class="line">   <span class="type">uint32_t</span>	cryptid;	<span class="comment">/* which enryption system,</span></span><br><span class="line"><span class="comment">				   0 means not-encrypted yet */</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>åŠ å¯†éƒ¨åˆ†æ˜¯Crypt Offset:0x4000 , Crypt Size: 0x4000,ä¸¤è€…ç›¸åŠ æœ«å°¾åœ°å€ä¸º0x8000,æ ¹æ®ä¸‹å›¾çœ‹,å®é™…åŠ å¯†çš„éƒ¨åˆ†æ˜¯ä»£ç Segmentçš„å†…å®¹</p>
<p><img src="https://s2.loli.net/2025/04/19/lOYZIouvECmTdDr.png" alt="2025-04-18 17.11.15.png"></p>
<p><img src="https://s2.loli.net/2025/04/19/YiCavdxw8t7LGM3.png" alt="2025-04-18 17.11.34.png"></p>
<h4 id="Command-LC-LOAD-DYLIB"><a href="#Command-LC-LOAD-DYLIB" class="headerlink" title="Command: LC_LOAD_DYLIB"></a>Command: LC_LOAD_DYLIB</h4><p>æœ‰è‹¥å¹²ä¸ªè¯¥å‘½ä»¤,ç”¨äºåŠ è½½ç³»ç»ŸåŠåº”ç”¨é“¾æ¥çš„åŠ¨æ€åº“</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Dynamicly linked shared libraries are identified by two things.  The</span></span><br><span class="line"><span class="comment"> * pathname (the name of the library as found for execution), and the</span></span><br><span class="line"><span class="comment"> * compatibility version number.  The pathname must match and the compatibility</span></span><br><span class="line"><span class="comment"> * number in the user of the library must be greater than or equal to the</span></span><br><span class="line"><span class="comment"> * library being used.  The time stamp is used to record the time a library was</span></span><br><span class="line"><span class="comment"> * built and copied into user so it can be use to determined if the library used</span></span><br><span class="line"><span class="comment"> * at runtime is exactly the same as used to built the program.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">dylib</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> <span class="title">lc_str</span>  <span class="title">name</span>;</span>			<span class="comment">/* library&#x27;s path name */</span></span><br><span class="line">    <span class="type">uint32_t</span> timestamp;			<span class="comment">/* library&#x27;s build time stamp */</span></span><br><span class="line">    <span class="type">uint32_t</span> current_version;		<span class="comment">/* library&#x27;s current version number */</span></span><br><span class="line">    <span class="type">uint32_t</span> compatibility_version;	<span class="comment">/* library&#x27;s compatibility vers number*/</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * A dynamically linked shared library (filetype == MH_DYLIB in the mach header)</span></span><br><span class="line"><span class="comment"> * contains a dylib_command (cmd == LC_ID_DYLIB) to identify the library.</span></span><br><span class="line"><span class="comment"> * An object that uses a dynamically linked shared library also contains a</span></span><br><span class="line"><span class="comment"> * dylib_command (cmd == LC_LOAD_DYLIB, LC_LOAD_WEAK_DYLIB, or</span></span><br><span class="line"><span class="comment"> * LC_REEXPORT_DYLIB) for each library it uses.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">dylib_command</span> &#123;</span></span><br><span class="line">	<span class="type">uint32_t</span>	cmd;		<span class="comment">/* LC_ID_DYLIB, LC_LOAD_&#123;,WEAK_&#125;DYLIB,</span></span><br><span class="line"><span class="comment">					   LC_REEXPORT_DYLIB */</span></span><br><span class="line">	<span class="type">uint32_t</span>	cmdsize;	<span class="comment">/* includes pathname string */</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">dylib</span>	<span class="title">dylib</span>;</span>		<span class="comment">/* the library identification */</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2025/04/19/ap3ARMj51S4WDvq.png" alt="2025-04-18 17.17.48.png"></p>
<p>nameå­—æ®µæŒ‡æ˜åŠ è½½è·¯å¾„</p>
<h4 id="Command-LC-RPATH"><a href="#Command-LC-RPATH" class="headerlink" title="Command: LC_RPATH"></a>Command: LC_RPATH</h4><p>å‰é¢åŠ¨æ€åº“nameé‡Œæœ‰@rpathå˜é‡çš„æè¿°,@rpathçš„å€¼åœ¨è¿™é‡ŒæŒ‡å®š</p>
<h4 id="Command-LC-FUNCTION-STARTS"><a href="#Command-LC-FUNCTION-STARTS" class="headerlink" title="Command: LC_FUNCTION_STARTS"></a>Command: LC_FUNCTION_STARTS</h4><p>è¯¥å‘½ä»¤ç”¨äºæè¿°å‡½æ•°çš„èµ·å§‹åœ°å€ä¿¡æ¯ï¼ŒæŒ‡å‘äº†é“¾æ¥ä¿¡æ¯æ®µä¸­ Function Starts çš„é¦–åœ°å€ Function Starts å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°èµ·å§‹åœ°å€è¡¨ï¼Œè°ƒè¯•å™¨å’Œå…¶ä»–ç¨‹åºé€šè¿‡è¯¥è¡¨å¯ä»¥å¾ˆå®¹æ˜“åœ°åˆ¤æ–­å‡ºä¸€ä¸ªåœ°å€æ˜¯å¦åœ¨å‡½æ•°å†…</p>
<h4 id="Command-LC-DATA-IN-CODE"><a href="#Command-LC-DATA-IN-CODE" class="headerlink" title="Command: LC_DATA_IN_CODE"></a>Command: LC_DATA_IN_CODE</h4><p>è¯¥å‘½ä»¤ä½¿ç”¨ä¸€ä¸ª struct linkedit_data_command æŒ‡å‘ä¸€ä¸ª data_in_code_entry æ•°ç»„ data_in_code_entry æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œç”¨äºæè¿°ä»£ç æ®µä¸­ä¸€ä¸ªå­˜å‚¨æ•°æ®çš„åŒºåŸŸ</p>
<h4 id="Command-LC-CODE-SIGATURE"><a href="#Command-LC-CODE-SIGATURE" class="headerlink" title="Command: LC_CODE_SIGATURE"></a>Command: LC_CODE_SIGATURE</h4><p>ç­¾åä¿¡æ¯çš„æè¿°ï¼Œä»è¿™é‡Œå¯çŸ¥,äºŒè¿›åˆ¶æ–‡ä»¶çš„ç­¾åæ˜¯åœ¨æ–‡ä»¶å†…</p>
<h3 id="Data"><a href="#Data" class="headerlink" title="Data"></a>Data</h3><p>Load Commandséƒ¨åˆ†æ˜¯åœ¨æè¿°MachOæ–‡ä»¶å¦‚ä½•ç»„ç»‡ã€‚æ¯”å¦‚ä»£ç éƒ¨åˆ†çš„é•¿åº¦æ˜¯å¤šå°‘,è¿™ç§å¾ˆåƒCè¯­è¨€æ“ä½œæ•°ç»„æ—¶è¦ä¼ é•¿åº¦ã€‚å¦‚æœå†æ‰©å±•ä¸€ä¸‹æ¦‚å¿µ,ç½‘ç»œåè®®é€šè¿‡å„ç§åŒ…çš„æ ¼å¼æ§åˆ¶æ•°æ®çš„ä¼ è¾“,é‚£å‰é¢è¿™äº›å‘½ä»¤ä¹Ÿæ˜¯åœ¨æ§åˆ¶å¦‚ä½•è§£æåé¢çš„Dataã€‚</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/317305471">MacOS é“¾æ¥ç‰¹æ€§ï¼šTwo-Level Namespace</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/NationalSecurityAgency/ghidra/issues/5938">ghidra-issues</a></li>
<li><a target="_blank" rel="noopener" href="https://juejin.cn/post/6977278725465309214">MachOæ–‡ä»¶å­¦ä¹ ç¬”è®°</a></li>
</ol>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Runtime/" rel="tag"># Runtime</a>
              <a href="/tags/Mechanism/" rel="tag"># Mechanism</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2025/04/17/Technology-learn-media-02/" rel="prev" title="éŸ³è§†é¢‘ - ffmpeg ç¼–è¯‘ä¸è°ƒè¯•">
      <i class="fa fa-chevron-left"></i> éŸ³è§†é¢‘ - ffmpeg ç¼–è¯‘ä¸è°ƒè¯•
    </a></div>
      <div class="post-nav-item">
    <a href="/2025/04/20/Technology-learn-ios-101/" rel="next" title="optoolä¸ºmachoæ–‡ä»¶å¢åŠ åŠ¨æ€åº“">
      optoolä¸ºmachoæ–‡ä»¶å¢åŠ åŠ¨æ€åº“ <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Mach-O%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84"><span class="nav-number">1.</span> <span class="nav-text">Mach-OåŸºæœ¬ç»“æ„</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Header"><span class="nav-number">1.1.</span> <span class="nav-text">Header</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Load-Commands"><span class="nav-number">2.</span> <span class="nav-text">Load Commands</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#LC-SEGMENT-64"><span class="nav-number">2.1.</span> <span class="nav-text">LC_SEGMENT_64</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8segment-command-64%E7%BB%93%E6%9E%84%E4%BD%93%E7%9A%84segment"><span class="nav-number">2.2.</span> <span class="nav-text">ä½¿ç”¨segment_command_64ç»“æ„ä½“çš„segment</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Segment-PAGEZERO"><span class="nav-number">2.2.1.</span> <span class="nav-text">Segment: __PAGEZERO</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Segment-TEXT-%E4%BB%A3%E7%A0%81"><span class="nav-number">2.2.2.</span> <span class="nav-text">Segment: __TEXT ä»£ç </span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Section-text"><span class="nav-number">2.2.2.1.</span> <span class="nav-text">Section: __text</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Section-stubs"><span class="nav-number">2.2.2.2.</span> <span class="nav-text">Section: __stubs</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Section-stub-helper"><span class="nav-number">2.2.2.3.</span> <span class="nav-text">Section: __stub_helper</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Section-objc-stubs"><span class="nav-number">2.2.2.4.</span> <span class="nav-text">Section: __objc_stubs</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Section-objc-methods"><span class="nav-number">2.2.2.5.</span> <span class="nav-text">Section: __objc_methods</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Section-objc-classname"><span class="nav-number">2.2.2.6.</span> <span class="nav-text">Section:__objc_classname</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Section-objc-methtype"><span class="nav-number">2.2.2.7.</span> <span class="nav-text">Section:__objc_methtype</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Section-cstring"><span class="nav-number">2.2.2.8.</span> <span class="nav-text">Section: __cstring</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Section-unwind-info"><span class="nav-number">2.2.2.9.</span> <span class="nav-text">Section: __unwind_info</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Segment-DATA-%E6%95%B0%E6%8D%AE"><span class="nav-number">2.2.3.</span> <span class="nav-text">Segment: __DATA æ•°æ®</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Section-got"><span class="nav-number">2.2.3.1.</span> <span class="nav-text">Section: __got</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Seciton-la-symbol-ptr"><span class="nav-number">2.2.3.2.</span> <span class="nav-text">Seciton: __la_symbol_ptr</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Section-cfstring"><span class="nav-number">2.2.3.3.</span> <span class="nav-text">Section: __cfstring</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Section-objc-classlist"><span class="nav-number">2.2.3.4.</span> <span class="nav-text">Section: __objc_classlist</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Section-objc-protolist"><span class="nav-number">2.2.3.5.</span> <span class="nav-text">Section: __objc_protolist</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Section-objc-imageInfo"><span class="nav-number">2.2.3.6.</span> <span class="nav-text">Section: __objc_imageInfo</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Section-objc-const"><span class="nav-number">2.2.3.7.</span> <span class="nav-text">Section: __objc_const</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Section-objc-selrefs"><span class="nav-number">2.2.3.8.</span> <span class="nav-text">Section: __objc_selrefs</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Section-objc-classrefs"><span class="nav-number">2.2.3.9.</span> <span class="nav-text">Section: __objc_classrefs</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Section-objc-superrefs"><span class="nav-number">2.2.3.10.</span> <span class="nav-text">Section: __objc_superrefs</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Section-objc-ivar"><span class="nav-number">2.2.3.11.</span> <span class="nav-text">Section: __objc_ivar</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Section-objc-data"><span class="nav-number">2.2.3.12.</span> <span class="nav-text">Section: __objc_data</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Section-data"><span class="nav-number">2.2.3.13.</span> <span class="nav-text">Section: __data</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Segment-LINKEDIT"><span class="nav-number">2.2.4.</span> <span class="nav-text">Segment: __LINKEDIT</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%85%B6%E4%BB%96%E7%BB%93%E6%9E%84%E4%BD%93%E7%9A%84Command"><span class="nav-number">2.3.</span> <span class="nav-text">ä½¿ç”¨å…¶ä»–ç»“æ„ä½“çš„Command</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Command-LC-DYLD-INFO-ONLY"><span class="nav-number">2.3.1.</span> <span class="nav-text">Command:LC_DYLD_INFO_ONLY</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Command-LC-SYMTAB"><span class="nav-number">2.3.2.</span> <span class="nav-text">Command: LC_SYMTAB</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Command-LC-DYSYMTAB"><span class="nav-number">2.3.3.</span> <span class="nav-text">Command: LC_DYSYMTAB</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Command-LC-LOAD-DYLINKER"><span class="nav-number">2.3.4.</span> <span class="nav-text">Command: LC_LOAD_DYLINKER</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Command-LC-UUID"><span class="nav-number">2.3.5.</span> <span class="nav-text">Command: LC_UUID</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Command-LC-VERSION-MIN-IPHONEOS"><span class="nav-number">2.3.6.</span> <span class="nav-text">Command: LC_VERSION_MIN_IPHONEOS</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Command-LC-SOURCE-VERSION"><span class="nav-number">2.3.7.</span> <span class="nav-text">Command: LC_SOURCE_VERSION</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Command-LC-MAIN"><span class="nav-number">2.3.8.</span> <span class="nav-text">Command: LC_MAIN</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Command-LC-ENCRYPTION-INFO-64"><span class="nav-number">2.3.9.</span> <span class="nav-text">Command: LC_ENCRYPTION_INFO_64</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Command-LC-LOAD-DYLIB"><span class="nav-number">2.3.10.</span> <span class="nav-text">Command: LC_LOAD_DYLIB</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Command-LC-RPATH"><span class="nav-number">2.3.11.</span> <span class="nav-text">Command: LC_RPATH</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Command-LC-FUNCTION-STARTS"><span class="nav-number">2.3.12.</span> <span class="nav-text">Command: LC_FUNCTION_STARTS</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Command-LC-DATA-IN-CODE"><span class="nav-number">2.3.13.</span> <span class="nav-text">Command: LC_DATA_IN_CODE</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Command-LC-CODE-SIGATURE"><span class="nav-number">2.3.14.</span> <span class="nav-text">Command: LC_CODE_SIGATURE</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Data"><span class="nav-number">2.4.</span> <span class="nav-text">Data</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83"><span class="nav-number">3.</span> <span class="nav-text">å‚è€ƒ</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">å¿˜å·ä¸‰</p>
  <div class="site-description" itemprop="description">404~ ~ ~å°±å¤šèµ°ä¸€æ­¥</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">85</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">27</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">å¿˜å·ä¸‰</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> å¼ºåŠ›é©±åŠ¨
  </div>


        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
