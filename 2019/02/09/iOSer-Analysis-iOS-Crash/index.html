<!DOCTYPE html>
<html class="has-navbar-fixed-top">
<head>
    <meta charset="utf-8">
<title>iOS崩溃日志分析 - 牧羊人</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css">




<meta name="description" content="一个闲散的程序员">



<meta name="keywords" content="iOSer CS">



    <meta name="description" content="环境 macOS Mojave 10.14.3Xcode10.1iPhone6S 10.0.1  获得崩溃日志方式一:Xcode菜单 &gt; Window &gt; Devices and Simulators 选择设备并查看设备日志(View Device Logs) 方式二:手机设置 &gt; 隐私 &gt; 诊断与用量 &gt; 诊断与用量数据">
<meta property="og:type" content="article">
<meta property="og:title" content="iOS崩溃日志分析">
<meta property="og:url" content="http://yoursite.com/2019/02/09/iOSer-Analysis-iOS-Crash/index.html">
<meta property="og:site_name" content="牧羊人">
<meta property="og:description" content="环境 macOS Mojave 10.14.3Xcode10.1iPhone6S 10.0.1  获得崩溃日志方式一:Xcode菜单 &gt; Window &gt; Devices and Simulators 选择设备并查看设备日志(View Device Logs) 方式二:手机设置 &gt; 隐私 &gt; 诊断与用量 &gt; 诊断与用量数据">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2019/02/09/5c5e3065d3d64.jpg">
<meta property="og:image" content="https://i.loli.net/2019/02/09/5c5e3065bbbe7.jpg">
<meta property="og:image" content="https://i.loli.net/2019/02/09/5c5e3065be846.jpg">
<meta property="og:image" content="https://i.loli.net/2019/02/09/5c5e3065d620b.jpg">
<meta property="og:image" content="https://i.loli.net/2019/02/09/5c5e30657abff.jpg">
<meta property="og:image" content="https://i.loli.net/2019/02/09/5c5e30662d74b.jpg">
<meta property="og:image" content="https://i.loli.net/2019/02/09/5c5e3066110ad.jpg">
<meta property="og:image" content="https://i.loli.net/2019/02/09/5c5e30666b349.jpg">
<meta property="og:image" content="https://i.loli.net/2019/02/09/5c5e30705b060.jpg">
<meta property="og:image" content="https://i.loli.net/2019/02/09/5c5e307076899.jpg">
<meta property="og:image" content="https://i.loli.net/2019/02/09/5c5e3066cffbb.png">
<meta property="og:image" content="https://i.loli.net/2019/02/09/5c5e30706411c.jpg">
<meta property="og:image" content="https://i.loli.net/2019/02/09/5c5e306717570.jpg">
<meta property="article:published_time" content="2019-02-09T01:46:02.000Z">
<meta property="article:modified_time" content="2022-12-11T10:04:40.123Z">
<meta property="article:author" content="Shepherd">
<meta property="article:tag" content="iOSer CS">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2019/02/09/5c5e3065d3d64.jpg">





<link rel="icon" href="/images/favicon.png">


<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ovo|Source+Code+Pro">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/css/justifiedGallery.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css">


<link rel="stylesheet" href="/css/style.css">


<script defer src="//use.fontawesome.com/releases/v5.0.8/js/all.js"></script>


    
    
    
    
    
    
    
    
    
    

    


<meta name="generator" content="Hexo 5.4.2"></head>
<body>
    
<nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item navbar-logo" href="/">
                
                    
                    牧羊人
                    
                
            </a>
            <div class="navbar-burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="navbar-menu navbar-start">
            
            <a class="navbar-item "
               href="/categories/Technology">技术</a>
            
            <a class="navbar-item "
               href="/categories/iOSer">iOSer</a>
            
            <a class="navbar-item "
               href="/categories">主题</a>
            
            <a class="navbar-item "
               href="/archives">时间流</a>
            
        </div>
        
        <div class="navbar-menu navbar-end">
            
            <a class="navbar-item search" title="搜索" href="javascript:;">
                <i class="fas fa-search"></i>
            </a>
            
            
            <div class="navbar-item is-hoverable has-dropdown is-hidden-mobile is-hidden-tablet-only toc">
                <a class="navbar-item" title="目录">
                    <i class="fa fa-list"></i>
                </a>
                <div class="navbar-dropdown is-right">
                    
                    
                    
                    
                    <a class="navbar-item" href="#环境">1&nbsp;&nbsp;<b>环境</b></a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#获得崩溃日志">2&nbsp;&nbsp;<b>获得崩溃日志</b></a>
                    
                    
                    
                    <a class="navbar-item" href="#方式一-Xcode">2.1&nbsp;&nbsp;方式一:Xcode</a>
                    
                    
                    
                    <a class="navbar-item" href="#方式二-手机">2.2&nbsp;&nbsp;方式二:手机</a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#崩溃日志的结构">3&nbsp;&nbsp;<b>崩溃日志的结构</b></a>
                    
                    
                    
                    <a class="navbar-item" href="#头部-Header">3.1&nbsp;&nbsp;头部(Header)</a>
                    
                    
                    
                    <a class="navbar-item" href="#异常信息-Exception-Information">3.2&nbsp;&nbsp;异常信息(Exception Information)</a>
                    
                    
                    
                    <a class="navbar-item" href="#其他诊断信息">3.3&nbsp;&nbsp;其他诊断信息</a>
                    
                    
                    
                    <a class="navbar-item" href="#线程回溯">3.4&nbsp;&nbsp;线程回溯</a>
                    
                    
                    
                    <a class="navbar-item" href="#线程状态">3.5&nbsp;&nbsp;线程状态</a>
                    
                    
                    
                    <a class="navbar-item" href="#二进制镜像">3.6&nbsp;&nbsp;二进制镜像</a>
                    
                    
                    
                    <a class="navbar-item" href="#关于异常类型-Exception-Type">3.7&nbsp;&nbsp;关于异常类型(Exception Type)</a>
                    
                    
                    
                    <a class="navbar-item" href="#野指针-Bad-Memory-Access-EXC-BAD-ACCESS-SIGSEGV-SIGBUS">3.7.1&nbsp;&nbsp;野指针(Bad Memory Access [EXC_BAD_ACCESS // SIGSEGV // SIGBUS])</a>
                    
                    
                    
                    <a class="navbar-item" href="#异常退出-Abnormal-Exit-EXC-CRASH-SIGABRT">3.7.2&nbsp;&nbsp;异常退出(Abnormal Exit [EXC_CRASH // SIGABRT])</a>
                    
                    
                    
                    <a class="navbar-item" href="#追踪陷阱-Trace-Trap-EXC-BREAKPOINT-SIGTRAP">3.7.3&nbsp;&nbsp;追踪陷阱(Trace Trap [EXC_BREAKPOINT // SIGTRAP])</a>
                    
                    
                    
                    <a class="navbar-item" href="#非法指令-Illegal-Instruction">3.7.4&nbsp;&nbsp;非法指令(Illegal Instruction)</a>
                    
                    
                    
                    <a class="navbar-item" href="#被杀死-Killed-SIGKILL">3.7.5&nbsp;&nbsp;被杀死(Killed[SIGKILL])</a>
                    
                    
                    
                    <a class="navbar-item" href="#资源限制-Resource-Limit-EXC-RESOURCE">3.7.6&nbsp;&nbsp;资源限制(Resource Limit [EXC_RESOURCE])</a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#符号化">4&nbsp;&nbsp;<b>符号化</b></a>
                    
                    
                    
                    <a class="navbar-item" href="#方式一-dSYM文件">4.1&nbsp;&nbsp;方式一:dSYM文件</a>
                    
                    
                    
                    <a class="navbar-item" href="#获取UUID">4.1.1&nbsp;&nbsp;获取UUID</a>
                    
                    
                    
                    <a class="navbar-item" href="#定位崩溃地址">4.1.2&nbsp;&nbsp;定位崩溃地址</a>
                    
                    
                    
                    <a class="navbar-item" href="#支持bitcode">4.1.3&nbsp;&nbsp;支持bitcode</a>
                    
                    
                    
                    <a class="navbar-item" href="#方式二-崩溃日志-Hopper">4.2&nbsp;&nbsp;方式二:崩溃日志 + Hopper</a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#异常捕获监听">5&nbsp;&nbsp;<b>异常捕获监听</b></a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#参考">6&nbsp;&nbsp;<b>参考</b></a>
                    
                </div>
            </div>
            
            
            <a class="navbar-item" title="GitHub" target="_blank" rel="noopener" href="https://github.com/ishepherdMiner">
                
                <i class="fab fa-github"></i>
                
            </a>
               
            
        </div>
    </div>
</nav>

    <section class="section">
    <div class="container">
    <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            iOS崩溃日志分析
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            
                <time datetime="2019-02-09T01:46:02.000Z" itemprop="datePublished">2月 9 2019</time>
            
        </span>
        <!--
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="/categories/iOSer/">iOSer</a>
        </span>
         
        -->
        
        <span class="column is-narrow">
            
            
            12 分钟 读完 (约 1861 字)
        </span>
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <html><head></head><body><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><blockquote>
<p><code>macOS Mojave 10.14.3</code><br><code>Xcode10.1</code><br><code>iPhone6S 10.0.1</code></p>
</blockquote>
<h2 id="获得崩溃日志"><a href="#获得崩溃日志" class="headerlink" title="获得崩溃日志"></a>获得崩溃日志</h2><h3 id="方式一-Xcode"><a href="#方式一-Xcode" class="headerlink" title="方式一:Xcode"></a>方式一:<code>Xcode</code></h3><p>菜单 &gt; <code>Window</code> &gt; <code>Devices and Simulators</code></p>
<p>选择设备并查看设备日志(<code>View Device Logs</code>)</p>
<h3 id="方式二-手机"><a href="#方式二-手机" class="headerlink" title="方式二:手机"></a>方式二:手机</h3><p>设置 &gt; 隐私 &gt; 诊断与用量 &gt; 诊断与用量数据</p>
<span id="more"></span>

<h2 id="崩溃日志的结构"><a href="#崩溃日志的结构" class="headerlink" title="崩溃日志的结构"></a>崩溃日志的结构</h2><h3 id="头部-Header"><a href="#头部-Header" class="headerlink" title="头部(Header)"></a>头部(Header)</h3><ul>
<li><code>Incident Identifier</code>: 崩溃日志的唯一标识</li>
<li><code>CrashReporter Key</code>: 匿名的设备标识</li>
<li><code>Process</code>:进程名</li>
<li><code>Path</code>:二进制文件路径</li>
<li><code>Identifier</code>:包名</li>
<li><code>Version</code>:应用版本号</li>
<li><code>Code Type</code>: 目标架构</li>
<li><code>Role</code>:进程终止时进程被赋予的<a target="_blank" rel="noopener" href="https://opensource.apple.com/source/xnu/xnu-3248.60.10/osfmk/mach/task_policy.h"><code>task_role</code></a>枚举值<br>…</li>
</ul>
<figure class="highlight plaintext hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Incident Identifier: F21EC10C-018D-494F-997D-E9C9D82B2F7F</span><br><span class="line">CrashReporter Key:   ab7fcdf6938542fd82446362e0481f7fddba141f</span><br><span class="line">Hardware Model:      iPhone6,2</span><br><span class="line">Process:             JACrash [27195]</span><br><span class="line">Path:                /private/var/containers/Bundle/Application/EDDDCB8E-75CE-4638-84CA-5B7971F6EFE0/JACrash.app/JACrash</span><br><span class="line">Identifier:          com.ishepherdme.JACrash</span><br><span class="line">Version:             1 (1.0)</span><br><span class="line">Code Type:           ARM-64 (Native)</span><br><span class="line">Role:                Foreground</span><br><span class="line">Parent Process:      launchd [1]</span><br><span class="line">Coalition:           com.ishepherdme.JACrash [4182]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Date/Time:           2019-02-08 13:03:58.7771 +0800</span><br><span class="line">Launch Time:         2019-02-08 13:03:58.3811 +0800</span><br><span class="line">OS Version:          iPhone OS 10.0.1 (14A403)</span><br><span class="line">Report Version:      104</span><br></pre></td></tr></tbody></table></figure>


<h3 id="异常信息-Exception-Information"><a href="#异常信息-Exception-Information" class="headerlink" title="异常信息(Exception Information)"></a>异常信息(Exception Information)</h3><ul>
<li><code>Triggered by Thread</code>: 产生崩溃的线程</li>
<li><code>Exception Type</code>: 崩溃类型<br>…</li>
</ul>
<figure class="highlight plaintext hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Exception Type:  EXC_CRASH (SIGABRT)</span><br><span class="line">Exception Codes: 0x0000000000000000, 0x0000000000000000</span><br><span class="line">Exception Note:  EXC_CORPSE_NOTIFY</span><br><span class="line">Triggered by Thread:  0</span><br></pre></td></tr></tbody></table></figure>

<h3 id="其他诊断信息"><a href="#其他诊断信息" class="headerlink" title="其他诊断信息"></a>其他诊断信息</h3><ul>
<li><code>Application Specific Information</code>:在进程终止时框架捕获的错误信息<br>…</li>
</ul>
<figure class="highlight plaintext hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Application Specific Information:</span><br><span class="line">abort() called</span><br><span class="line"></span><br><span class="line">Filtered syslog:</span><br><span class="line">None found</span><br></pre></td></tr></tbody></table></figure>

<h3 id="线程回溯"><a href="#线程回溯" class="headerlink" title="线程回溯"></a>线程回溯</h3><p>罗列崩溃时每个线程的调用栈情况</p>
<figure class="highlight plaintext hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Thread 0 name:  Dispatch queue: com.apple.main-thread</span><br><span class="line">Thread 0 Crashed:</span><br><span class="line">0   libsystem_kernel.dylib        	0x000000018af0e014 __pthread_kill + 8</span><br><span class="line">1   libsystem_pthread.dylib       	0x000000018afd5460 pthread_kill + 112</span><br><span class="line">2   libsystem_c.dylib             	0x000000018ae823f4 abort + 140</span><br><span class="line">3   libc++abi.dylib               	0x000000018a94d2d4 __cxa_bad_cast + 0</span><br><span class="line">4   libc++abi.dylib               	0x000000018a96acc0 default_unexpected_handler+ 126144 () + 0</span><br><span class="line">5   libobjc.A.dylib               	0x000000018a978844 _objc_terminate+ 34884 () + 124</span><br><span class="line">6   libc++abi.dylib               	0x000000018a96766c std::__terminate(void (*)+ 112236 ()) + 16</span><br><span class="line">7   libc++abi.dylib               	0x000000018a967234 __cxa_rethrow + 144</span><br><span class="line">8   libobjc.A.dylib               	0x000000018a97871c objc_exception_rethrow + 44</span><br><span class="line">9   CoreFoundation                	0x000000018be1a0bc CFRunLoopRunSpecific + 560</span><br><span class="line">10  UIKit                         	0x0000000191df37cc -[UIApplication _run] + 608</span><br><span class="line">11  UIKit                         	0x0000000191dee550 UIApplicationMain + 208</span><br><span class="line">12  JACrash                       	0x000000010007de90 0x100078000 + 24208</span><br><span class="line">13  libdyld.dylib                 	0x000000018adfc5b8 start + 4</span><br></pre></td></tr></tbody></table></figure>

<h3 id="线程状态"><a href="#线程状态" class="headerlink" title="线程状态"></a>线程状态</h3><p>列出崩溃线程的线程状态。这是一个寄存器列表及其执行停止时的值。在阅读崩溃报告时，无需了解线程状态，但可以使用此信息更好地了解崩溃的情况。</p>
<figure class="highlight plaintext hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Thread 0 crashed with ARM Thread State (64-bit):</span><br><span class="line">    x0: 0x0000000000000000   x1: 0x0000000000000000   x2: 0x0000000000000000   x3: 0x00000001740e9737</span><br><span class="line">    x4: 0x000000018a96bbc3   x5: 0x000000016fd87520   x6: 0x000000000000006e   x7: 0xffffffffffffffec</span><br><span class="line">    x8: 0x0000000008000000   x9: 0x0000000004000000  x10: 0x000000000000000b  x11: 0x0000000000000010</span><br><span class="line">   x12: 0x000000018ae99792  x13: 0x0000000000000000  x14: 0x0000030000000300  x15: 0x0000000000000000</span><br><span class="line">   x16: 0x0000000000000148  x17: 0x0000000000000000  x18: 0x0000000000000000  x19: 0x0000000000000006</span><br><span class="line">   x20: 0x00000001b0bf8c40  x21: 0x000000016fd87520  x22: 0x00000001b0bffbb8  x23: 0x0000000000000001</span><br><span class="line">   x24: 0x0000000170011110  x25: 0x0000000000000000  x26: 0x0000000000000001  x27: 0x0000000000000000</span><br><span class="line">   x28: 0x000000016fd87b80   fp: 0x000000016fd87480   lr: 0x000000018afd5460</span><br><span class="line">    sp: 0x000000016fd87460   pc: 0x000000018af0e014 cpsr: 0x00000000</span><br></pre></td></tr></tbody></table></figure>

<h3 id="二进制镜像"><a href="#二进制镜像" class="headerlink" title="二进制镜像"></a>二进制镜像</h3><p>进程二进制文件加载的地址区间,动态库加载的地址区间</p>
<figure class="highlight plaintext hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Binary Images:</span><br><span class="line">0x100078000 - 0x10007ffff JACrash arm64  &lt;2fd461c16e7239489a037c6c1141c134&gt; /var/containers/Bundle/Application/A55333A1-CD62-41A2-AE96-F3411ECD3447/JACrash.app/JACrash</span><br><span class="line">0x10009c000 - 0x10009ffff MobileSubstrate.dylib arm64  &lt;3134cfb2f722310ea2c742ae4dc131ab&gt; /Library/MobileSubstrate/MobileSubstrate.dylib</span><br><span class="line">0x1000a8000 - 0x1000affff libswiftCoreFoundation.dylib arm64  &lt;47deeaa1967b3e339dfcb48535a994e1&gt; /var/containers/Bundle/Application/A55333A1-CD62-41A2-AE96-F3411ECD3447/JACrash.app/Frameworks/libswiftCoreFoundation.dylib</span><br><span class="line">0x1000bc000 - 0x1000cbfff libswiftCoreGraphics.dylib arm64  &lt;25fe91aa901b3cf6a443b498012ab5af&gt; /var/containers/Bundle/Application/A55333A1-CD62-41A2-AE96-F3411ECD3447/JACrash.app/Frameworks/libswiftCoreGraphics.dylib</span><br><span class="line">0x1000f0000 - 0x1000f7fff libswiftCoreImage.dylib arm64  </span><br><span class="line">....</span><br></pre></td></tr></tbody></table></figure>

<h3 id="关于异常类型-Exception-Type"><a href="#关于异常类型-Exception-Type" class="headerlink" title="关于异常类型(Exception Type)"></a>关于异常类型(<code>Exception Type</code>)</h3><h4 id="野指针-Bad-Memory-Access-EXC-BAD-ACCESS-SIGSEGV-SIGBUS"><a href="#野指针-Bad-Memory-Access-EXC-BAD-ACCESS-SIGSEGV-SIGBUS" class="headerlink" title="野指针(Bad Memory Access [EXC_BAD_ACCESS // SIGSEGV // SIGBUS])"></a>野指针(<code>Bad Memory Access [EXC_BAD_ACCESS // SIGSEGV // SIGBUS]</code>)</h4><p>尝试访问了非法的内存地址,或访问了受保护的地址</p>
<p><img src="https://i.loli.net/2019/02/09/5c5e3065d3d64.jpg"></p>
<figure class="highlight plaintext hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Exception Type:  EXC_BAD_ACCESS (SIGSEGV)</span><br><span class="line">Exception Subtype: KERN_INVALID_ADDRESS at 0x000000064229beb8</span><br><span class="line">Termination Signal: Segmentation fault: 11</span><br><span class="line">Termination Reason: Namespace SIGNAL, Code 0xb</span><br><span class="line">Terminating Process: exc handler [0]</span><br><span class="line">Triggered by Thread:  0</span><br></pre></td></tr></tbody></table></figure>


<p>比如在<code>MRC</code>环境下尝试发送消息给已释放的对象,调用栈的特点是<code>objc_msgSend</code>/<code>objc_release</code>在调用栈顶</p>
<h4 id="异常退出-Abnormal-Exit-EXC-CRASH-SIGABRT"><a href="#异常退出-Abnormal-Exit-EXC-CRASH-SIGABRT" class="headerlink" title="异常退出(Abnormal Exit [EXC_CRASH // SIGABRT])"></a>异常退出(<code>Abnormal Exit [EXC_CRASH // SIGABRT]</code>)</h4><figure class="highlight objc hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">ViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="hljs-type">void</span>)viewDidLoad {</span><br><span class="line">    [<span class="variable language_">super</span> viewDidLoad];</span><br><span class="line">    [<span class="hljs-keyword">self</span> callCrashMethod];</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">- (<span class="hljs-type">void</span>)callCrashMethod {</span><br><span class="line">    [<span class="hljs-keyword">self</span> arrayOutOfBounds];</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">- (<span class="hljs-type">void</span>)arrayOutOfBounds {</span><br><span class="line">    <span class="hljs-built_in">NSArray</span> *arr = @[<span class="hljs-string">@"0"</span>,<span class="hljs-string">@"1"</span>];</span><br><span class="line">    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@"%@"</span>,arr[<span class="hljs-number">2</span>]);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">@end</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight plaintext hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Exception Type:  EXC_CRASH (SIGABRT)</span><br><span class="line">Exception Codes: 0x0000000000000000, 0x0000000000000000</span><br><span class="line">Exception Note:  EXC_CORPSE_NOTIFY</span><br><span class="line">Triggered by Thread:  0</span><br></pre></td></tr></tbody></table></figure>

<p><img src="https://i.loli.net/2019/02/09/5c5e3065bbbe7.jpg"></p>
<p>崩溃会直接到<code>main</code>,因为调用栈中包含<code>objc_exception_rethrow</code>栈帧,根据<a href="#refer1">参考1</a>,进行如下的配置,设置异常的断点</p>
<blockquote>
<p><strong>The Exception Breakpoint</strong><br>So how do you find the line in the code that made the app crash? Well, whenever you get a stacktrace like this, an exception was thrown by the app. (You can tell because one of the functions in the call stack is named objc_exception_rethrow.)</p>
</blockquote>
<p><img src="https://i.loli.net/2019/02/09/5c5e3065be846.jpg"></p>
<p><img src="https://i.loli.net/2019/02/09/5c5e3065d620b.jpg"></p>
<h4 id="追踪陷阱-Trace-Trap-EXC-BREAKPOINT-SIGTRAP"><a href="#追踪陷阱-Trace-Trap-EXC-BREAKPOINT-SIGTRAP" class="headerlink" title="追踪陷阱(Trace Trap [EXC_BREAKPOINT // SIGTRAP])"></a>追踪陷阱(<code>Trace Trap [EXC_BREAKPOINT // SIGTRAP]</code>)</h4><p>这个异常是为调试器提供在进程执行的特定点中断进程的机会。</p>
<p><img src="https://i.loli.net/2019/02/09/5c5e30657abff.jpg"></p>
<figure class="highlight plaintext hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Exception Type:  EXC_BREAKPOINT (SIGTRAP)</span><br><span class="line">Exception Codes: 0x0000000000000001, 0x000000010006e588</span><br><span class="line">Termination Signal: Trace/BPT trap: 5</span><br><span class="line">Termination Reason: Namespace SIGNAL, Code 0x5</span><br><span class="line">Terminating Process: exc handler [0]</span><br><span class="line">Triggered by Thread:  0</span><br></pre></td></tr></tbody></table></figure>

<h4 id="非法指令-Illegal-Instruction"><a href="#非法指令-Illegal-Instruction" class="headerlink" title="非法指令(Illegal Instruction)"></a>非法指令(<code>Illegal Instruction</code>)</h4><p>进程试图执行非法或未定义指令。这个进程可能试图通过一个配置错误的函数指针，跳到一个无效的地址。</p>
<figure class="highlight plaintext hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Exception Type:  EXC_CRASH (SIGILL)</span><br><span class="line">Exception Codes: 0x0000000000000000, 0x0000000000000000</span><br><span class="line">Exception Note:  EXC_CORPSE_NOTIFY</span><br><span class="line">Termination Signal: Illegal instruction: 4</span><br><span class="line">Termination Reason: Namespace SIGNAL, Code 0x4</span><br><span class="line">Terminating Process: neteasemusic [6562]</span><br><span class="line">Triggered by Thread:  0</span><br></pre></td></tr></tbody></table></figure>

<h4 id="被杀死-Killed-SIGKILL"><a href="#被杀死-Killed-SIGKILL" class="headerlink" title="被杀死(Killed[SIGKILL])"></a>被杀死(<code>Killed[SIGKILL]</code>)</h4><figure class="highlight plaintext hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Exception Type:  EXC_CRASH (SIGKILL)</span><br><span class="line">Exception Codes: 0x0000000000000000, 0x0000000000000000</span><br><span class="line">Exception Note:  EXC_CORPSE_NOTIFY</span><br><span class="line">Termination Reason: Namespace SPRINGBOARD, Code 0x8badf00d</span><br><span class="line">Triggered by Thread:  0</span><br></pre></td></tr></tbody></table></figure>

<h4 id="资源限制-Resource-Limit-EXC-RESOURCE"><a href="#资源限制-Resource-Limit-EXC-RESOURCE" class="headerlink" title="资源限制(Resource Limit [EXC_RESOURCE])"></a>资源限制(<code>Resource Limit [EXC_RESOURCE]</code>)</h4><p>这个进程超出了资源消耗的限制。</p>
<h2 id="符号化"><a href="#符号化" class="headerlink" title="符号化"></a>符号化</h2><p><img src="https://i.loli.net/2019/02/09/5c5e30662d74b.jpg"></p>
<p>来自<a href="#refer3">参考3</a></p>
<h3 id="方式一-dSYM文件"><a href="#方式一-dSYM文件" class="headerlink" title="方式一:dSYM文件"></a>方式一:<code>dSYM</code>文件</h3><p><code>DWARF</code> 即<code>Debugging with Attributed Record Formats</code>,<code>Xcode</code>使用它来生成符号表,生成的符号表放在<code>.dSYM</code>文件中,在<code>Debug</code>模式下,默认不会生成<code>.dSYM</code>文件,可以在<code>Build Settings</code>中进行设置</p>
<p><img src="https://i.loli.net/2019/02/09/5c5e3066110ad.jpg"></p>
<p>编译后,在工程中<code>Product</code>目录下,选择应用程序,<code>Show in Finder</code>,会发现生成了应用的<code>.dSYM</code>文件</p>
<h4 id="获取UUID"><a href="#获取UUID" class="headerlink" title="获取UUID"></a>获取<code>UUID</code></h4><figure class="highlight plaintext hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Binary Images:</span><br><span class="line">0x1000f8000 - 0x1000fffff JACrash arm64  &lt;2fd461c16e7239489a037c6c1141c134&gt; /var/containers/Bundle/Application/7B72F18F-930E-42CB-B69C-FED75161A03F/JACrash.app/JACrash</span><br></pre></td></tr></tbody></table></figure>

<p><code>UUID:2fd461c16e7239489a037c6c1141c134</code></p>
<figure class="highlight sh hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">% dwarfdump --uuid path/to/Your.app.dSYM/Contents/Resources/DWARF/JACrash</span><br><span class="line">...</span><br><span class="line">UUID: 2FD461C1-6E72-3948-9A03-7C6C1141C134 (arm64) /Users/Jason/Library/Developer/Xcode/DerivedData/JACrash-bntjxfwsvrraeuevozrbvraorxqv/Build/Products/Debug-iphoneos/JACrash.app.dSYM/Contents/Resources/DWARF/JACrash</span><br></pre></td></tr></tbody></table></figure>

<p>两者<code>UDID</code>一致即可</p>
<h4 id="定位崩溃地址"><a href="#定位崩溃地址" class="headerlink" title="定位崩溃地址"></a>定位崩溃地址</h4><figure class="highlight plaintext hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">% atos -o path/to/Your.app.dSYM/Contents/Resources/DWARF/Your -arch arm64 -l 0x1000f8000 0x1000fdda8</span><br><span class="line"></span><br><span class="line">-[ViewController arrayOutOfBounds] (in JACrash) (ViewController.m:33)</span><br></pre></td></tr></tbody></table></figure>

<p><code>0x1000f8000</code>: 运行时应用基地址<br><code>0x1000fdda8</code>: 运行时崩溃地址(待符号化的地址)</p>
<h4 id="支持bitcode"><a href="#支持bitcode" class="headerlink" title="支持bitcode"></a>支持<code>bitcode</code></h4><p><img src="https://i.loli.net/2019/02/09/5c5e30666b349.jpg"></p>
<p>支持<code>bitcode</code>的情况下,因为最终的二进制文件由<code>Apple Store</code>后台生成,本地是没有对应的<code>.dSYM</code>文件,可以从<code>Xcode</code>或<code>iTunes Connect</code>上下载</p>
<h3 id="方式二-崩溃日志-Hopper"><a href="#方式二-崩溃日志-Hopper" class="headerlink" title="方式二:崩溃日志 + Hopper"></a>方式二:崩溃日志 + <code>Hopper</code></h3><p>如果没有<code>.dSYM</code>文件,但有崩溃日志的情况时</p>
<p><strong>崩溃地址 = 基地址 + <a href="#refer4"><code>ASLR</code></a> + 方法偏移地址</strong></p>
<p><img src="https://i.loli.net/2019/02/09/5c5e30705b060.jpg"></p>
<p><strong>方法相对基地址的偏移地址是不变的</strong>,因此只要把<code>ASLR</code>从崩溃地址中移除,再加上方法的偏移地址即可</p>
<p>用<code>hopper</code>找出基地址,再加上方法偏移地址</p>
<p><img src="https://i.loli.net/2019/02/09/5c5e307076899.jpg"></p>
<p><img src="https://i.loli.net/2019/02/09/5c5e3066cffbb.png" alt="Snip20190208_26"></p>
<p><img src="https://i.loli.net/2019/02/09/5c5e30706411c.jpg"></p>
<h2 id="异常捕获监听"><a href="#异常捕获监听" class="headerlink" title="异常捕获监听"></a>异常捕获监听</h2><figure class="highlight objc hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">/// 函数指针,用于自定义捕获异常后要进行的操作</span></span><br><span class="line"><span class="hljs-keyword">typedef</span> <span class="hljs-type">void</span> <span class="hljs-built_in">NSUncaughtExceptionHandler</span>(<span class="hljs-built_in">NSException</span> *exception);</span><br><span class="line"></span><br><span class="line">FOUNDATION_EXPORT <span class="hljs-built_in">NSUncaughtExceptionHandler</span> * _Nullable <span class="hljs-built_in">NSGetUncaughtExceptionHandler</span>(<span class="hljs-type">void</span>);</span><br><span class="line">FOUNDATION_EXPORT <span class="hljs-type">void</span> <span class="hljs-built_in">NSSetUncaughtExceptionHandler</span>(<span class="hljs-built_in">NSUncaughtExceptionHandler</span> * _Nullable);</span><br></pre></td></tr></tbody></table></figure>

<p>在程序启动时加上一个异常捕获监听，用来处理程序崩溃时的回调动作</p>
<figure class="highlight objc hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-type">void</span> exceptionHandler(<span class="hljs-built_in">NSException</span> *exception) {</span><br><span class="line">    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@"%@"</span>, [exception reason]);</span><br><span class="line">    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@"%@"</span>, [exception userInfo]);</span><br><span class="line">    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@"%@"</span>, [exception callStackSymbols]);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-type">int</span> main(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span> * argv[]) {</span><br><span class="line">    <span class="hljs-built_in">NSSetUncaughtExceptionHandler</span>(&amp;exceptionHandler);</span><br><span class="line">    <span class="hljs-keyword">@autoreleasepool</span> {</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-built_in">UIApplicationMain</span>(argc, argv, <span class="hljs-literal">nil</span>, <span class="hljs-built_in">NSStringFromClass</span>([AppDelegate <span class="hljs-keyword">class</span>]));</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p><img src="https://i.loli.net/2019/02/09/5c5e306717570.jpg"></p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ol>
<li><span id="refer1"><a target="_blank" rel="noopener" href="https://www.raywenderlich.com/2943-my-app-crashed-now-what-part-1">My App Crashed, Now What? – Part 1</a></span></li>
<li><a target="_blank" rel="noopener" href="http://foggry.com/blog/2015/07/27/ru-he-shou-dong-jie-xi-crashlog/">手动解析CrashLog之—-方法篇</a></li>
<li><span id="refer3"><a target="_blank" rel="noopener" href="https://developer.apple.com/library/archive/technotes/tn2151/_index.html">Understanding and Analyzing Application Crash Reports</a></span></li>
<li><span id="refer4"><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Address_space_layout_randomization">Address space layout randomization</a></span></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/1128539/nssetuncaughtexceptionhandler-not-catch-all-errors-on-iphone">NSSetUncaughtExceptionHandler not catch all errors on iPhone
</a></li>
</ol>
</body></html>
    
    </div>
    
    
    <div class="columns is-mobile is-multiline article-nav">
        <span class="column is-12-mobile is-half-desktop  article-nav-prev">
            
            <a href="/2019/02/22/Technology-ReactNative-Intro/">ReactNative 入门体验</a>
            
        </span>
        <span class="column is-12-mobile is-half-desktop  article-nav-next">
            
            <a href="/2019/01/09/Technology-Charles-capture-principle/">Charles HTTP抓包原理</a>
            
        </span>
    </div>
    
</article>




    </div>
</section>
    <footer class="footer">
    <div class="container">
        <div class="columns content">
            <div class="column is-narrow has-text-centered">
                &copy; 2025 Shepherd&nbsp;
                Разработано на базе <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        target="_blank" rel="noopener" href="http://github.com/ppoffice/hexo-theme-minos">Minos</a>
            </div>
            <div class="column is-hidden-mobile"></div>

            
            <div class="column is-narrow">
                <div class="columns is-mobile is-multiline is-centered">
                
                    
                <a class="column is-narrow has-text-black" title="GitHub" target="_blank" rel="noopener" href="https://github.com/ppoffice/hexo-theme-minos">
                    
                    GitHub
                    
                </a>
                
                </div>
            </div>
            
            
        </div>
    </div>
</footer>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script>

<!-- test if the browser is outdated -->
<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" target="_blank" rel="noopener" href="http://outdatedbrowser.com/">Update my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js"></script>
<script>
    $(document).ready(function () {
        // plugin function, place inside DOM ready function
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        })
    });
</script>

<script>
    window.FontAwesomeConfig = {
        searchPseudoElements: true
    }
    moment.locale("zh-CN");
</script>


    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>
    MathJax.Hub.Config({
        "HTML-CSS": {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
</script>

    
    
    
    
<script src="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/js/lightgallery-all.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/js/jquery.justifiedGallery.min.js"></script>
<script>
    (function ($) {
        $(document).ready(function () {
            if (typeof($.fn.lightGallery) === 'function') {
                $('.article.gallery').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof($.fn.justifiedGallery) === 'function') {
                $('.justified-gallery > p > .gallery-item').unwrap();
                $('.justified-gallery').justifiedGallery();
            }
        });
    })(jQuery);
</script>

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <style>
        .hljs {
            position: relative;
        }

        .hljs .clipboard-btn {
            float: right;
            color: #9a9a9a;
            background: none;
            border: none;
            cursor: pointer;
        }

        .hljs .clipboard-btn:hover {
          color: #8a8a8a;
        }

        .hljs > .clipboard-btn {
            display: none;
            position: absolute;
            right: 4px;
            top: 4px;
        }

        .hljs:hover > .clipboard-btn {
            display: inline;
        }

        .hljs > figcaption > .clipboard-btn {
            margin-right: 4px;
        }
    </style>
    <script>
      $(document).ready(function () {
        $('figure.hljs').each(function(i, figure) {
          var codeId = 'code-' + i;
          var code = figure.querySelector('.code');
          var copyButton = $('<button>Copy <i class="far fa-clipboard"></i></button>');
          code.id = codeId;
          copyButton.addClass('clipboard-btn');
          copyButton.attr('data-clipboard-target-id', codeId);

          var figcaption = figure.querySelector('figcaption');

          if (figcaption) {
            figcaption.append(copyButton[0]);
          } else {
            figure.prepend(copyButton[0]);
          }
        })

        var clipboard = new ClipboardJS('.clipboard-btn', {
          target: function(trigger) {
            return document.getElementById(trigger.getAttribute('data-clipboard-target-id'));
          }
        });
        clipboard.on('success', function(e) {
          e.clearSelection();
        })
      })
    </script>

    
    

    



<script src="/js/script.js"></script>


    
    <div class="searchbox ins-search">
    <div class="searchbox-mask"></div>
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="站内搜索" />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '页面',
                CATEGORIES: '分类',
                TAGS: '标签',
                UNTITLED: '(无标题)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>

<script src="/js/insight.js"></script>

    
</body>
</html>