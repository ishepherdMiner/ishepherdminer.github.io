<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png">
  <link rel="mask-icon" href="/images/favicon.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="å®šä¹‰HTTPSï¼ˆä¹Ÿç§°ä¸º HTTP over TLS ï¼ŒHTTP over SSL ï¼Œå’Œ HTTP Secure ï¼‰æ˜¯ç”¨äºåœ¨å› ç‰¹ç½‘ä¸Šå¹¿æ³›ä½¿ç”¨çš„è®¡ç®—æœºç½‘ç»œä¸Šçš„å®‰å…¨é€šä¿¡çš„åè®®ã€‚HTTPS é€šè¿‡ TLS æˆ–å…¶å‰èº«çš„ SSL å®ç°è¶…æ–‡æœ¬ä¼ è¾“â€‹â€‹åè®®ï¼ˆHTTPï¼‰çš„å®‰å…¨ä¼ è¾“ã€‚ åœ¨å¯†ç å­¦ä¸­ï¼ŒåŠ å¯†ï¼ˆè‹±è¯­ï¼šEncryption ï¼‰æ˜¯å°†æ˜æ–‡ä¿¡æ¯æ”¹å˜ä¸ºéš¾ä»¥è¯»å–çš„å¯†æ–‡å†…å®¹ï¼Œä½¿ä¹‹ä¸å¯è¯»ã€‚åªæœ‰æ‹¥æœ‰è§£å¯†æ–¹æ³•çš„å¯¹è±¡ï¼Œç»ç”±è§£å¯†è¿‡ç¨‹ï¼Œ">
<meta property="og:type" content="article">
<meta property="og:title" content="HTTPSåè®®">
<meta property="og:url" content="http://yoursite.com/2017/03/21/Technology-Analysis-of-Https-protocol/index.html">
<meta property="og:site_name" content="ğŸ‘¨ğŸ»â€ğŸ’»&#39;s åšå®¢">
<meta property="og:description" content="å®šä¹‰HTTPSï¼ˆä¹Ÿç§°ä¸º HTTP over TLS ï¼ŒHTTP over SSL ï¼Œå’Œ HTTP Secure ï¼‰æ˜¯ç”¨äºåœ¨å› ç‰¹ç½‘ä¸Šå¹¿æ³›ä½¿ç”¨çš„è®¡ç®—æœºç½‘ç»œä¸Šçš„å®‰å…¨é€šä¿¡çš„åè®®ã€‚HTTPS é€šè¿‡ TLS æˆ–å…¶å‰èº«çš„ SSL å®ç°è¶…æ–‡æœ¬ä¼ è¾“â€‹â€‹åè®®ï¼ˆHTTPï¼‰çš„å®‰å…¨ä¼ è¾“ã€‚ åœ¨å¯†ç å­¦ä¸­ï¼ŒåŠ å¯†ï¼ˆè‹±è¯­ï¼šEncryption ï¼‰æ˜¯å°†æ˜æ–‡ä¿¡æ¯æ”¹å˜ä¸ºéš¾ä»¥è¯»å–çš„å¯†æ–‡å†…å®¹ï¼Œä½¿ä¹‹ä¸å¯è¯»ã€‚åªæœ‰æ‹¥æœ‰è§£å¯†æ–¹æ³•çš„å¯¹è±¡ï¼Œç»ç”±è§£å¯†è¿‡ç¨‹ï¼Œ">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ooo.0o0.ooo/2017/03/20/58cf6a6e00b06.png">
<meta property="og:image" content="https://ooo.0o0.ooo/2017/03/20/58cf6a6cec082.jpg">
<meta property="og:image" content="https://ooo.0o0.ooo/2017/03/20/58cf6acee4afc.jpg">
<meta property="og:image" content="https://ooo.0o0.ooo/2017/03/20/58cf6a6d05328.jpg">
<meta property="og:image" content="https://ooo.0o0.ooo/2017/03/20/58cf6a6d41247.jpg">
<meta property="og:image" content="https://ooo.0o0.ooo/2017/03/20/58cf6a6d54f9a.jpg">
<meta property="og:image" content="https://ooo.0o0.ooo/2017/03/20/58cf6a6e1189b.jpg">
<meta property="og:image" content="https://ooo.0o0.ooo/2017/03/20/58cf6a6e2c0a3.jpg">
<meta property="og:image" content="https://ooo.0o0.ooo/2017/03/20/58cf6a6deb2dc.jpg">
<meta property="og:image" content="https://ooo.0o0.ooo/2017/03/20/58cf6a6e24ab5.jpg">
<meta property="article:published_time" content="2017-03-21T11:22:21.000Z">
<meta property="article:modified_time" content="2025-04-26T14:15:26.209Z">
<meta property="article:author" content="å¿˜å·ä¸‰">
<meta property="article:tag" content="iOSer CS">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ooo.0o0.ooo/2017/03/20/58cf6a6e00b06.png">

<link rel="canonical" href="http://yoursite.com/2017/03/21/Technology-Analysis-of-Https-protocol/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>HTTPSåè®® | ğŸ‘¨ğŸ»â€ğŸ’»'s åšå®¢</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">ğŸ‘¨ğŸ»â€ğŸ’»'s åšå®¢</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">æ…¢å“äººé—´çƒŸç«è‰²ï¼Œé—²è§‚ä¸‡äº‹å²æœˆé•¿</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/03/21/Technology-Analysis-of-Https-protocol/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="å¿˜å·ä¸‰">
      <meta itemprop="description" content="404~ ~ ~å°±å¤šèµ°ä¸€æ­¥">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ğŸ‘¨ğŸ»â€ğŸ’»'s åšå®¢">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          HTTPSåè®®
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2017-03-21 19:22:21" itemprop="dateCreated datePublished" datetime="2017-03-21T19:22:21+08:00">2017-03-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-04-26 22:15:26" itemprop="dateModified" datetime="2025-04-26T22:15:26+08:00">2025-04-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Network/" itemprop="url" rel="index"><span itemprop="name">Network</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h2><p><em>HTTPS</em>ï¼ˆä¹Ÿç§°ä¸º <em>HTTP over TLS</em> ï¼Œ<em>HTTP over SSL</em> ï¼Œå’Œ <em>HTTP Secure</em> ï¼‰æ˜¯ç”¨äºåœ¨å› ç‰¹ç½‘ä¸Šå¹¿æ³›ä½¿ç”¨çš„è®¡ç®—æœºç½‘ç»œä¸Šçš„å®‰å…¨é€šä¿¡çš„åè®®ã€‚<em>HTTPS</em> é€šè¿‡ <em>TLS</em> æˆ–å…¶å‰èº«çš„ <em>SSL</em> å®ç°è¶…æ–‡æœ¬ä¼ è¾“â€‹â€‹åè®®ï¼ˆ<em>HTTP</em>ï¼‰çš„å®‰å…¨ä¼ è¾“ã€‚</p>
<p>åœ¨å¯†ç å­¦ä¸­ï¼Œ<strong>åŠ å¯†</strong>ï¼ˆè‹±è¯­ï¼š<em>Encryption</em> ï¼‰æ˜¯å°†æ˜æ–‡ä¿¡æ¯æ”¹å˜ä¸ºéš¾ä»¥è¯»å–çš„å¯†æ–‡å†…å®¹ï¼Œä½¿ä¹‹ä¸å¯è¯»ã€‚åªæœ‰æ‹¥æœ‰<strong>è§£å¯†</strong>æ–¹æ³•çš„å¯¹è±¡ï¼Œç»ç”±è§£å¯†è¿‡ç¨‹ï¼Œæ‰èƒ½å°†å¯†æ–‡è¿˜åŸä¸ºæ­£å¸¸å¯è¯»çš„å†…å®¹ã€‚</p>
<span id="more"></span>

<h2 id="å¯¹ç§°åŠ å¯†-amp-éå¯¹ç§°åŠ å¯†"><a href="#å¯¹ç§°åŠ å¯†-amp-éå¯¹ç§°åŠ å¯†" class="headerlink" title="å¯¹ç§°åŠ å¯† &amp; éå¯¹ç§°åŠ å¯†"></a>å¯¹ç§°åŠ å¯† &amp; éå¯¹ç§°åŠ å¯†</h2><p>åœ¨ç°ä»£åŠ å¯†ä½“åˆ¶ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Symmetric-key_algorithm">å¯¹ç§°åŠ å¯†</a>,å³åœ¨åŠ å¯†ä¸è§£å¯†çš„è¿‡ç¨‹ä¸­ä½¿ç”¨ç›¸åŒçš„åŠ å¯†å¯†é’¥ (<em>cryptographic keys</em>) çš„ç®—æ³•,æ¯”å¦‚ <em>DES</em>ã€<em>RC4</em>ã€<em>AES</em>ã€‚</li>
<li><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Public-key_cryptography">éå¯¹ç§°/å…¬å¼€åŠ å¯†</a>,ä¼šä½¿ç”¨ä¸€å¯¹å¯†é’¥ï¼Œåˆ†åˆ«å‘½åä¸ºå…¬é’¥ä¸ç§é’¥ï¼Œä¸¤ä¸ªå¯†é’¥å¯ä»¥äº’ç›¸åŠ è§£å¯†ã€‚å¤–éƒ¨å¯ä»¥è·å–å…¬é’¥ï¼Œä½†ç§é’¥ä¸€èˆ¬åªæœ‰æ‰€æœ‰è€…æ‰çŸ¥é“ã€‚æˆ‘ä»¬æœ€ç†Ÿæ‚‰çš„éå¯¹ç§°åŠ å¯†åº”è¯¥å°±æ˜¯ <em>RSA</em> å§ã€‚</li>
</ul>
<h3 id="ä¼˜ç¼ºç‚¹"><a href="#ä¼˜ç¼ºç‚¹" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹</h3><p>å¯¹ç§°åŠ å¯†çš„ç¼ºç‚¹ä¸»è¦åœ¨äºå¯†é’¥å¿…é¡»åŒæ–¹å…±äº«ï¼Œå¦åˆ™æ— æ³•å®ç°åŠ è§£å¯†ï¼Œåªè¦å…¶ä¸­ä¸€æ–¹(ä¸»è¦æŒ‡å®¢æˆ·ç«¯)æš´éœ²äº†å¯†é’¥ï¼ŒåŠ å¯†è¿‡ç¨‹å°±ä¸å®‰å…¨äº†ï¼Œéå¯¹ç§°åŠ å¯†å…‹æœäº†è¿™ä¸€ç‚¹ï¼Œå®¢æˆ·ç«¯è·å¾—çš„æ˜¯æœåŠ¡å™¨çš„å…¬é’¥ï¼Œæœ¬æ¥å°±æ˜¯å…¬å¼€çš„ï¼Œè¢«äººè·å–ä¹Ÿä¸å½±å“ã€‚è™½ç„¶éå¯¹ç§°åŠ å¯†æœ‰è¿™ä¸ªå¥½å¤„,ä½†æ˜¯å®ƒçš„åŠ å¯†çš„æ•ˆç‡æ¯”å¯¹ç§°åŠ å¯†é€Šè‰²ã€‚æ‰€ä»¥åœ¨ <em>HTTPS</em> ä¸­ä¸¤è€…éƒ½è¢«ä½¿ç”¨åˆ°äº†ã€‚è®¤è¯è¿‡ç¨‹é‡‡ç”¨äº†éå¯¹ç§°åŠ å¯†ï¼Œè€Œå®é™…æ•°æ®çš„ä¼ è¾“ä½¿ç”¨äº†å¯¹ç§°åŠ å¯†ã€‚</p>
<h2 id="éå¯¹ç§°åŠ å¯†çš„ç”¨é€”"><a href="#éå¯¹ç§°åŠ å¯†çš„ç”¨é€”" class="headerlink" title="éå¯¹ç§°åŠ å¯†çš„ç”¨é€”"></a>éå¯¹ç§°åŠ å¯†çš„ç”¨é€”</h2><blockquote>
<p><strong>å…¬é’¥åŠ å¯† + ç§é’¥è§£å¯† ç”¨äºé€šä¿¡åŠ å¯†</strong><br><strong>ç§é’¥åŠ å¯† + å…¬é’¥è§£å¯† ç”¨äºèº«ä»½è®¤è¯</strong></p>
</blockquote>
<p><strong>å› æ­¤æœåŠ¡å™¨ç”¨ç§é’¥åŠ å¯†çš„å†…å®¹ï¼Œåªè¦æŒæœ‰å…¬é’¥ï¼Œéƒ½æ˜¯å¯ä»¥è§£å¯†çš„</strong></p>
<h2 id="SSL-æ¡æ‰‹æµç¨‹"><a href="#SSL-æ¡æ‰‹æµç¨‹" class="headerlink" title="SSL æ¡æ‰‹æµç¨‹"></a>SSL æ¡æ‰‹æµç¨‹</h2><p><img src="https://ooo.0o0.ooo/2017/03/20/58cf6a6e00b06.png"></p>
<p>å›¾ç‰‡æ¥è‡ª<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/zh-hant/%E5%82%B3%E8%BC%B8%E5%B1%A4%E5%AE%89%E5%85%A8%E5%8D%94%E8%AD%B0">wiki - ä¼ è¾“å±‚å®‰å…¨åè®®</a>ï¼Œæè¿°çš„æ˜¯ <em>SSL</em> çš„æ¡æ‰‹æµç¨‹ã€‚</p>
<h3 id="åå•†åŠ å¯†ç®—æ³•"><a href="#åå•†åŠ å¯†ç®—æ³•" class="headerlink" title="åå•†åŠ å¯†ç®—æ³•"></a>åå•†åŠ å¯†ç®—æ³•</h3><ol>
<li>å®¢æˆ·ç«¯å‘é€ <em>ClientHello</em> æ¶ˆæ¯ï¼ŒåŒ…å«æ”¯æŒçš„åè®®ç‰ˆæœ¬ï¼ŒåŠ å¯†å’Œå‹ç¼©ç®—æ³•ç­‰ï¼Œä¸€ä¸ªå®¢æˆ·ç«¯ç”Ÿæˆçš„éšæœºæ•° <em>RNc</em>ã€‚</li>
<li>æœåŠ¡å™¨æ”¶åˆ° <em>ClientHello</em> æ¶ˆæ¯åï¼Œå‘é€ <em>ServerHello</em> ç¡®å®šè¦é‡‡ç”¨çš„åè®®ç‰ˆæœ¬ï¼ŒåŠ å¯†å’Œå‹ç¼©ç®—æ³•ç­‰ï¼ŒåŒæ—¶ç”Ÿæˆä¸€ä¸ªéšæœºæ•° <em>RNs</em>ã€‚</li>
</ol>
<blockquote>
<p><em>RNc</em> ä¸ <em>RNs</em> å°†ç”¨äºå‚ä¸åé¢çš„ <strong>ç”Ÿæˆå¯¹ç§°åŠ å¯†å¯†é’¥</strong> è¿‡ç¨‹</p>
</blockquote>
<h3 id="äº¤æ¢è¯ä¹¦"><a href="#äº¤æ¢è¯ä¹¦" class="headerlink" title="äº¤æ¢è¯ä¹¦"></a>äº¤æ¢è¯ä¹¦</h3><blockquote>
<p>å…³äºè¯ä¹¦ï¼Œåœ¨æ­¤å¤„å¯ç†è§£ä¸ºä¸€ç§èº«ä»½è®¤è¯çš„æ–¹å¼ï¼Œåé¢è¯´æ˜</p>
</blockquote>
<ol>
<li>æœåŠ¡å™¨ä¼šå‘é€è¯ä¹¦(åŒ…å«è‡ªèº«çš„å…¬é’¥)å‘é€ç»™å®¢æˆ·ç«¯ï¼Œå¹¶è¦æ±‚å®¢æˆ·ç«¯è¯ä¹¦</li>
<li>å®¢æˆ·ç«¯ä¼šæ ¡éªŒæœåŠ¡å™¨å‘é€çš„è¯ä¹¦æ˜¯å¦å¯ä¿¡ï¼Œå¦‚æœä¸å¯ä¿¡ï¼Œåˆ™å…³é—­è¿æ¥ï¼Œè‹¥å¯ä¿¡ï¼Œç»§ç»­æ‰§è¡Œ</li>
<li>å®¢æˆ·ç«¯ä¼šå‘é€è¯ä¹¦(åŒ…å«è‡ªèº«çš„å…¬é’¥)åˆ°æœåŠ¡å™¨ï¼Œè¿™åœ¨åŒå‘è®¤è¯æ—¶è¦æ±‚ï¼Œä¸€èˆ¬æƒ…å†µä¸‹åªè¦å‘é€éšæœºç”Ÿæˆçš„å…¬é’¥å³å¯ï¼Œä¸»è¦è¿˜æ˜¯è¦ç¡®è®¤æœåŠ¡å™¨æ˜¯å®‰å…¨å¯ä¿¡çš„ã€‚</li>
<li>æœåŠ¡å™¨æ£€éªŒå®¢æˆ·ç«¯è¯ä¹¦ï¼Œè·å¾—å…¬é’¥ï¼Œç»§ç»­æ‰§è¡Œ</li>
<li>å®¢æˆ·ç«¯ä¼šå°†åˆšæ‰å‘é€çš„ä¿¡æ¯è¿›è¡Œ <em>hash</em> å¹¶ç”¨è‡ªå·±çš„ç§é’¥è¿›è¡ŒåŠ å¯†/ç­¾åï¼Œ</li>
<li>æœåŠ¡å™¨æ¥æ”¶åä¼šç”¨å¾—åˆ°çš„å®¢æˆ·ç«¯çš„å…¬é’¥å…ˆè§£å¯†å¹¶ç”¨ç›¸åŒçš„ç®—æ³•è¿›è¡Œ <em>hash</em> æ¯”è¾ƒç»“æœ</li>
</ol>
<p>æœ€åçš„ä¸¤æ­¥ï¼Œæˆ‘ä¸ç¡®å®šç”¨é€”ï¼Œåªèƒ½æ£æµ‹æ˜¯ä¸ºäº†è¯æ˜æœåŠ¡å™¨å·²ç»æ”¶åˆ°äº†å®¢æˆ·ç«¯çš„å…¬é’¥åŒæ—¶ç®—æ³•éƒ½æ²¡æœ‰é—®é¢˜ã€‚</p>
<h3 id="ç”Ÿæˆå¯¹ç§°åŠ å¯†å¯†é’¥"><a href="#ç”Ÿæˆå¯¹ç§°åŠ å¯†å¯†é’¥" class="headerlink" title="ç”Ÿæˆå¯¹ç§°åŠ å¯†å¯†é’¥"></a>ç”Ÿæˆå¯¹ç§°åŠ å¯†å¯†é’¥</h3><p>åœ¨<a target="_blank" rel="noopener" href="https://www.ietf.org/rfc/rfc2246.txt">RFC 2246 - The TLS Protocol Version 1.0 </a>ä¸­,æœ‰å¦‚ä¸‹çš„ä¸€æ®µè¯</p>
<blockquote>
<p>7.4.7.1. RSA encrypted premaster secret message<br>â€¦<br>Structure of this message:<br>ã€€ã€€ã€€struct {<br>ã€€ã€€ã€€ã€€ã€€ProtocolVersion client_version;<br>ã€€ã€€ã€€ã€€ã€€opaque random[46];<br>ã€€ã€€ã€€} PreMasterSecret;<br>ã€€ã€€ã€€client_version<br>ã€€ã€€ã€€ã€€ã€€The latest (newest) version supported by the client. This is<br>ã€€ã€€ã€€ã€€ã€€used to detect version roll-back attacks. Upon receiving the<br>ã€€ã€€ã€€ã€€ã€€premaster secret, the server should check that this value<br>ã€€ã€€ã€€ã€€ã€€matches the value transmitted by the client in the client<br>ã€€ã€€ã€€ã€€ã€€hello message.<br>ã€€ã€€ã€€random<br>ã€€ã€€ã€€ã€€ã€€46 securely-generated random bytes.</p>
</blockquote>
<p>å› æ­¤ <em>pre master key</em> çš„ç»“æ„ä¸º <em>2</em> å­—èŠ‚åè®®ç‰ˆæœ¬ï¼ŒåŒ¹é…å®¢æˆ·ç«¯ä¸€å¼€å§‹å‘é€ <em>ClientHello</em> æ—¶æ‰€æä¾›çš„ä¿¡æ¯ï¼Œ<em>46</em> å­—èŠ‚éšæœºæ•°ã€‚å®ƒçš„ä½œç”¨æ˜¯ä¸ºäº†ä¸åå•†åŠ å¯†ç®—æ³•é˜¶æ®µä¸­éšæœºç”Ÿæˆçš„ä¸¤ä¸ªæ•° <em>RNc</em> å’Œ <em>RNs</em> ç»„åˆï¼Œæœ€ç»ˆç”Ÿæˆæœ¬æ¬¡ä¼šè¯ä¸­ç”¨äºå¯¹ç§°åŠ å¯†çš„å¯†é’¥( <em>Master secret</em> )ã€‚</p>
<blockquote>
<p>Generate a master secret from the premaster secret and exchanged random values.</p>
</blockquote>
<ol>
<li>å®¢æˆ·ç«¯ç”Ÿæˆ <em>pre master key</em>ï¼Œå¹¶é€šè¿‡æœåŠ¡å™¨çš„å…¬é’¥åŠ å¯†åå‘é€ç»™æœåŠ¡å™¨</li>
<li>æœåŠ¡å™¨ç”¨è‡ªå·±çš„ç§é’¥è§£å¯†ï¼ŒåŒæ–¹ç°åœ¨éƒ½æœ‰ <em>pre master key</em> + <em>RNc</em> + <em>RNs</em></li>
<li>å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä½¿ç”¨ç›¸åŒçš„ç®—æ³•å°† <em>pre master key</em> + <em>RNc</em> + <em>RNs</em> å„è‡ªè¿›è¡Œè®¡ç®—ï¼Œç”Ÿæˆ <em>Master secret</em> </li>
<li>å®¢æˆ·ç«¯é€šçŸ¥æœåŠ¡å™¨æ¥ä¸‹æ¥çš„é€šä¿¡ç”¨ <em>Master secret</em> åšä¸ºå¯¹ç§°åŠ å¯†çš„å¯†é’¥ï¼Œç»“æŸ <em>SSL</em> æ¡æ‰‹é€šä¿¡</li>
<li>æœåŠ¡å™¨æ”¶åˆ°æ¶ˆæ¯åï¼ŒåŒæ ·å‘é€æ¶ˆæ¯åˆ°å®¢æˆ·ç«¯ï¼Œç¡®è®¤ä½¿ç”¨ <em>Master secret</em> ä¸ºå¯¹ç§°åŠ å¯†çš„å¯†é’¥ï¼Œç»“æŸ <em>SSL</em> æ¡æ‰‹é€šä¿¡ã€‚</li>
</ol>
<h2 id="æ•°å­—è¯ä¹¦"><a href="#æ•°å­—è¯ä¹¦" class="headerlink" title="æ•°å­—è¯ä¹¦"></a>æ•°å­—è¯ä¹¦</h2><p>ä¸ºä»€ä¹ˆåœ¨ <em>HTTPS</em> ä¼šè¯ä¸­è¦ç”¨åˆ°æ•°å­—è¯ä¹¦ï¼Ÿ</p>
<p>æˆ‘ä»¬çœ‹åˆ°äº¤æ¢è¯ä¹¦çš„è¿‡ç¨‹ä¸­æœåŠ¡å™¨å‘é€çš„è¯ä¹¦ä¸­åŒ…å«äº†å®ƒçš„å…¬é’¥ï¼Œè¯•æƒ³å¦‚æœæœ‰ä¸æ€€å¥½æ„çš„<strong>ä¸­é—´äºº</strong>æ‹¦æˆªäº†è¯·æ±‚ï¼Œä¸å®¢æˆ·ç«¯åå•†äº†åŠ å¯†çš„ç®—æ³•ï¼Œæ¥æ”¶ <em>RNc</em> å¹¶å‘é€ <em>RNs</em> ,ç„¶åå°†è‡ªå·±çš„å…¬é’¥å‘é€ç»™å®¢æˆ·ç«¯ã€‚å®¢æˆ·ç«¯ä¸åšæ ¡éªŒå°±æ¥æ”¶äº†ï¼Œé‚£åé¢çš„æ•´ä¸ªè¿‡ç¨‹éƒ½æ˜¯ä¸å®‰å…¨çš„ã€‚æ‰€ä»¥<strong>éœ€è¦ä¸€ä¸ªå‡­è¯</strong>è®©å®¢æˆ·ç«¯æ¥éªŒè¯è¿™ä¸ªå…¬é’¥æ˜¯ä¸æ˜¯å±äºä¸å…¶é€šä¿¡çš„æœåŠ¡å™¨ã€‚</p>
<p><strong>æ•°å­—è¯ä¹¦å°±å……å½“äº†è¿™ä¸ªæä¾›å‡­è¯çš„è§’è‰²</strong></p>
<h3 id="å®šä¹‰-1"><a href="#å®šä¹‰-1" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>åœ¨<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/zh-hans/%E9%9B%BB%E5%AD%90%E8%AD%89%E6%9B%B8">wiki-ç”µå­è¯ä¹¦</a>ä¸­è¡¨æ˜äº†æ•°å­—è¯ä¹¦å¹¶éæ•°å­—èº«ä»½è¯ï¼Œè€Œæ˜¯èº«ä»½è®¤è¯æœºæ„ç›–åœ¨æ•°å­—èº«ä»½è¯ä¸Šçš„ä¸€ä¸ªç« æˆ–å°ï¼ˆæˆ–è€…è¯´åŠ åœ¨æ•°å­—èº«ä»½è¯ä¸Šçš„ä¸€ä¸ªç­¾åï¼‰ï¼Œè¿™ä¸€è¡Œä¸ºè¡¨ç¤ºèº«ä»½è®¤è¯æœºæ„å·²è®¤å®šè¿™ä¸ªæŒè¯äººã€‚</p>
<h3 id="æ —å­"><a href="#æ —å­" class="headerlink" title="æ —å­"></a>æ —å­</h3><p>æ‰“å¼€é’¥åŒ™ä¸²ï¼ŒæŸ¥çœ‹ä¸€ä¸ªæ•°å­—è¯ä¹¦</p>
<p><img src="https://ooo.0o0.ooo/2017/03/20/58cf6a6cec082.jpg"></p>
<h3 id="CA"><a href="#CA" class="headerlink" title="CA"></a>CA</h3><p><em>CA</em> (<em>certificate authority</em>) å°±æ˜¯ä¸€ä¸ªæä¾›èº«ä»½è®¤è¯çš„æœºæ„ï¼Œä¸ºä»€ä¹ˆä¿¡ä»» <em>CA</em>ï¼Œè¯ä¹¦çš„ä¿¡ä»»æ˜¯é“¾å¼çš„å‘ä¸Šä¼ é€’ã€‚åœ¨ <em>mac</em> ä¸Šå¼€å‘è€…è¯ä¹¦çš„ä¿¡ä»»é—®é¢˜æœ€ç»ˆä¼šèµ°åˆ°è‹¹æœçš„æ ¹è¯ä¹¦ä¸Šï¼Œå› ä¸ºæˆ‘ä»¬ä¿¡ä»»äº†è¿™ä¸ªè¯ä¹¦ï¼Œæ‰€ä»¥åé¢è‹¹æœæœåŠ¡å™¨( <em>CA</em> )ç­¾åçš„è¯ä¹¦æˆ‘ä»¬ä¹Ÿä¼šä¿¡ä»»ã€‚</p>
<p><img src="https://ooo.0o0.ooo/2017/03/20/58cf6acee4afc.jpg"></p>
<p>è€Œå¯¹äº <em>12306</em> ç½‘ç«™æµè§ˆå™¨ä¹‹æ‰€ä»¥ä¼šå¼¹å‡º<br><img src="https://ooo.0o0.ooo/2017/03/20/58cf6a6d05328.jpg"></p>
<p>åŒæ ·æ˜¯å› ä¸ºç³»ç»Ÿä¸ä¿¡ä»» <em>12306</em> çš„æ ¹è¯ä¹¦ <em>SRCA</em> ,æ‰€ä»¥ç”±å®ƒç­¾å‘çš„ <em>kyfw.12306.cn</em> è¯ä¹¦ä¹Ÿæ˜¯ä¸å—ä¿¡ä»»çš„ã€‚ </p>
<h3 id="csr-Certificate-Signing-request"><a href="#csr-Certificate-Signing-request" class="headerlink" title="csr (Certificate Signing request)"></a>csr (Certificate Signing request)</h3><blockquote>
<p>What is a CSR? A CSR or Certificate Signing request is a block of encoded text that is given to a Certificate Authority when applying for an SSL Certificate. It is usually generated on the server where the certificate will be installed and contains information that will be included in the certificate such as the organization name, common name (domain name), locality, and country. It also contains the public key that will be included in the certificate. A private key is usually created at the same time that you create the CSR, making a key pair. A CSR is generally encoded using ASN.1 according to the PKCS #10 specification.</p>
</blockquote>
<p>æˆ‘ä»¬é€šè¿‡é’¥åŒ™ä¸²åˆ›å»ºçš„ <em>csr</em> æ–‡ä»¶ä¼šåŒ…å«äº†ç»„ç»‡åï¼ŒåŸŸåï¼Œå›½å®¶ç­‰ä¿¡æ¯ï¼ŒåŒæ—¶è¿˜åŒ…å«äº†<strong>å…¬é’¥</strong>ã€‚åœ¨ç”Ÿæˆ <em>csr</em> æ–‡ä»¶æ—¶ä¹Ÿç”Ÿæˆäº†å¯¹åº”çš„ç§é’¥ï¼Œä¿å­˜åœ¨é’¥åŒ™ä¸²ä¸­ã€‚</p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>æˆ‘ä»¬å¹³æ—¶é€šè¿‡é’¥åŒ™ä¸²é€šè¿‡åˆ›å»º <em>csr</em> è¯·æ±‚æ–‡ä»¶çš„è¡Œä¸ºï¼Œå®é™…ä¸Šæ˜¯å°†è‡ªèº«ä¿¡æ¯å’Œç”Ÿæˆçš„å…¬é’¥æ”¾åˆ°å…¶ä¸­ï¼Œå‘é€ç»™è‹¹æœæœåŠ¡å™¨åï¼Œè‹¹æœæœåŠ¡å™¨ä¼šä½¿ç”¨è‡ªå·±çš„ç§é’¥å¯¹å…¶è¿›è¡Œç­¾åï¼Œç”Ÿæˆ <em>cer</em> æ–‡ä»¶ï¼Œæˆ‘ä»¬ä¸‹è½½åˆ°å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯å‘ç°è¯¥è¯ä¹¦æ˜¯å¯ä¿¡çš„ï¼Œå°±ä»é’¥åŒ™ä¸²ä¸­æ‰¾åˆ°å¹¶ä¸å®ƒçš„ç§é’¥ä¸€èµ·è¿›è¡Œé…ç½®ã€‚</p>
<p>è‹¹æœæœåŠ¡å™¨åœ¨è¿™ä¸ªåœºæ™¯ä¸‹å®é™…å……å½“äº† <em>CA</em> çš„è§’è‰²ï¼Œè‹¥æ˜¯æœåŠ¡å™¨æœ¬èº«è‡ªå·±åš <em>CA</em> è¿›è¡Œç­¾åä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œè¿™ç§æƒ…å†µä¸‹ç§°ä¸ºè‡ªç­¾åï¼Œä½†æ˜¯åœ¨ <em>HTTPS</em> çš„ä¼šè¯ä¸­å¯¹è¯ä¹¦è¿›è¡Œæ ¡éªŒæ—¶ä¸€èˆ¬ä¼šå¤±è´¥ï¼Œå®¢æˆ·ç«¯éœ€è¦æ“ä½œä¿¡ä»»è¯¥è¯ä¹¦ã€‚</p>
<p>åˆ°è¿™é‡Œï¼Œå¤§è‡´å¯ä»¥æ€»ç»“å‡ºæ•°å­—è¯ä¹¦çš„äº§ç”Ÿè¿‡ç¨‹</p>
<p>åœ¨ <em>HTTPS</em> åè®®ä¸­ï¼Œå®¢æˆ·ç«¯çš„è¯ä¹¦éªŒè¯ä¸ä¸Šé¢çš„åœºæ™¯ç±»ä¼¼ï¼ŒæœåŠ¡å™¨é¢„å…ˆä» <em>CA</em> é‚£è·å¾—æ•°å­—è¯ä¹¦ï¼Œå½“å®¢æˆ·ç«¯è¦æ±‚è¯ä¹¦æ—¶ï¼Œå°†è¯¥è¯ä¹¦è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œåªè¦å®¢æˆ·ç«¯ä¿¡ä»» <em>CA</em> , å°±å¯ä»¥é€šè¿‡ <em>CA</em> çš„å…¬é’¥è§£å¯†å‡ºæœåŠ¡å™¨å‘æ¥çš„è¯ä¹¦( <em>CA</em> ç”¨ç§é’¥ç­¾åæœåŠ¡å™¨çš„ä¸€äº›ä¿¡æ¯ä¸å…¬é’¥)ï¼Œä»è€Œå¾—åˆ°å…¬é’¥ï¼ŒåŒæ—¶åˆ¤å®šå…¬é’¥æ˜¯æ¥è‡ªæœåŠ¡å™¨çš„ã€‚</p>
<p>ä½†æ˜¯è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœ<strong>ä¸­é—´äºº</strong>ä¹Ÿè¯·æ±‚äº† <em>CA</em> ç”Ÿæˆäº†å¯¹åº”çš„è¯ä¹¦ï¼Œå®¢æˆ·ç«¯ä¾ç„¶æ— æ³•ç¡®å®šå…¬é’¥æ˜¯æ¥è‡ªæœåŠ¡å™¨çš„ï¼Œè¿˜æœ‰æ˜¯å¦æœ‰è¢«ä¿®æ”¹ã€‚</p>
<p>å‚è€ƒ <a target="_blank" rel="noopener" href="http://blog.jobbole.com/110354/">ä¹Ÿè®¸ï¼Œè¿™æ ·ç†è§£HTTPSæ›´å®¹æ˜“</a> è¿™ç¯‡æ–‡ç« å¯çŸ¥ï¼Œè¦ç”±å®¢æˆ·ç«¯è´Ÿè´£å»æ ¡éªŒè¯ä¹¦æ˜¯å¦åˆæ³•ã€‚</p>
<p>å…·ä½“æ–¹å¼æ˜¯å®¢æˆ·ç«¯å¾—åˆ°è¯ä¹¦åï¼Œæ ¹æ®è¯ä¹¦çš„å†…å®¹(æ¯”å¦‚è¯´æœåŠ¡å™¨åŸŸå)å’Œç®—æ³•ï¼Œå®¢æˆ·ç«¯å†ç”Ÿæˆä¸€éç­¾åçš„è¿‡ç¨‹ï¼Œç„¶åä¸è¯ä¹¦ç¼–å·è¿›è¡Œæ¯”è¾ƒï¼Œå› ä¸ºæ¯ä¸ªè¯ä¹¦çš„ç¼–å·åº”è¯¥æ˜¯å”¯ä¸€çš„ï¼Œæ‰€ä»¥ä¸­é—´äººä¸èƒ½åˆ›å»ºä¸€ä¸ªå’ŒåŸè¯ä¹¦å†…å®¹ä¸åŒï¼Œç„¶åç¼–å·å´ç›¸åŒã€‚å¦‚æœå‡ºç°äº†ï¼Œé‚£ä¹Ÿæ˜¯ç®—æ³•å‡ºçš„é—®é¢˜ï¼Œä¸æ˜¯è®¾è®¡æ€è·¯æœ‰æ¼æ´ã€‚å› æ­¤å®¢æˆ·ç«¯å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼éªŒè¯å½“å‰è·å¾—çš„è¯ä¹¦æ˜¯å¦ç¬¦åˆè¦æ±‚ã€‚ä»è€Œå¾—åˆ°å±äºæœåŠ¡å™¨çš„å…¬é’¥ï¼Œæ¥ç€å†ç»§ç»­ <em>HTTPS</em> ä¼šè¯ã€‚</p>
<h2 id="å®è·µ"><a href="#å®è·µ" class="headerlink" title="å®è·µ"></a>å®è·µ</h2><p>ç°åœ¨æ¥åŠ¨æ‰‹æ“ä½œï¼Œé€šè¿‡ <em>Wireshark</em> æ•è· <em>HTTPS</em> è¯·æ±‚æ¥éªŒè¯æ•´ä¸ªæµç¨‹ã€‚<br>å¦‚æœç›´æ¥æ‰‹åŠ¨æ‰“å¼€ <em>Wireshark</em> ç„¶åå°è¯•æ•è· <em>eth0</em> ç½‘å¡ï¼Œå¯èƒ½ä¼šæŠ¥æƒé™ä¸è¶³çš„æ–¹æ³•ã€‚ç®€å•çš„æ–¹æ³•å°±æ˜¯ç”¨ç»ˆç«¯ç›´æ¥ <em>sudo Wireshark</em> æ‰“å¼€</p>
<p>å› ä¸ºç½‘ç»œçš„ä¿¡æ¯éå¸¸å¤šï¼Œéœ€è¿›è¡Œè¿‡æ»¤</p>
<blockquote>
<p>tcp.srcport == 443 or tcp.dstport == 443</p>
</blockquote>
<p>æˆ‘ä»¬åªå…³æ³¨èµ° <em>443</em> ç«¯å£çš„ <em>tcp</em> åè®®</p>
<p>è®¿é—® <em><a target="_blank" rel="noopener" href="https://www.baidu.com/">https://www.baidu.com</a></em></p>
<p>å‡ºç°äº† <em>Client Hello</em> , <em>Server Hello</em> ç­‰ <em>info</em> ä¾æ¬¡åˆ°é‡Œé¢çœ‹çœ‹</p>
<p><img src="https://ooo.0o0.ooo/2017/03/20/58cf6a6d41247.jpg"></p>
<h3 id="å®è·µ-Client-Hello"><a href="#å®è·µ-Client-Hello" class="headerlink" title="[å®è·µ]Client Hello"></a>[å®è·µ]Client Hello</h3><p><img src="https://ooo.0o0.ooo/2017/03/20/58cf6a6d54f9a.jpg"></p>
<ul>
<li>åè®®ç‰ˆæœ¬ <em>tls 1.2 (0x0303)</em> <em>2</em> ä¸ªå­—èŠ‚</li>
<li>éšæœºæ•° <em>RNc</em> : <em>27ca27â€¦</em></li>
<li>å®¢æˆ·ç«¯æ”¯æŒçš„åŠ å¯†æ–¹å¼ : <em>TLS_EMPTY_RENEGOTIATION_INFO_SCSV 0x00ffâ€¦</em></li>
<li><em>Extension</em> : <em>server_name</em> ä¸‹æœ‰ <em><a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a></em></li>
</ul>
<h3 id="å®è·µ-Server-Hello"><a href="#å®è·µ-Server-Hello" class="headerlink" title="[å®è·µ]Server Hello"></a>[å®è·µ]Server Hello</h3><p><img src="https://ooo.0o0.ooo/2017/03/20/58cf6a6e1189b.jpg"></p>
<p>æœåŠ¡å™¨ç¡®å®šäº†åè®®ç‰ˆæœ¬å·,ç”Ÿæˆäº† <em>RNs</em>ï¼Œç¡®å®šäº†åŠ å¯†çš„æ–¹æ³•</p>
<h3 id="å®è·µ-è¯ä¹¦äº¤æ¢"><a href="#å®è·µ-è¯ä¹¦äº¤æ¢" class="headerlink" title="[å®è·µ]è¯ä¹¦äº¤æ¢"></a>[å®è·µ]è¯ä¹¦äº¤æ¢</h3><p><img src="https://ooo.0o0.ooo/2017/03/20/58cf6a6e2c0a3.jpg"></p>
<p>æœåŠ¡å™¨å°†åŒ…å«è‡ªå·±å…¬é’¥çš„æ•°å­—è¯ä¹¦å‘é€ç»™å®¢æˆ·ç«¯</p>
<p>å®¢æˆ·ç«¯éªŒè¯è¯ä¹¦é€šè¿‡åï¼Œå°†å‘é€å…¬é’¥ç»™æœåŠ¡å™¨</p>
<p><img src="https://ooo.0o0.ooo/2017/03/20/58cf6a6deb2dc.jpg"></p>
<h3 id="å®è·µ-ç”Ÿæˆå¯¹ç§°åŠ å¯†å¯†é’¥"><a href="#å®è·µ-ç”Ÿæˆå¯¹ç§°åŠ å¯†å¯†é’¥" class="headerlink" title="[å®è·µ]ç”Ÿæˆå¯¹ç§°åŠ å¯†å¯†é’¥"></a>[å®è·µ]ç”Ÿæˆå¯¹ç§°åŠ å¯†å¯†é’¥</h3><p>åŒæ–¹äº’ç›¸é€šçŸ¥å¯¹æ–¹ï¼Œå‡†å¤‡ç”¨åŠ å¯†ç®—æ³•å¯¹æ•°æ®åŠ å¯†äº†ï¼ŒåŒæ—¶ç»“æŸæ¡æ‰‹é€šä¿¡</p>
<p><img src="https://ooo.0o0.ooo/2017/03/20/58cf6a6e24ab5.jpg"></p>
<p>ä½†æ˜¯å¥½åƒå°‘äº† <em>SSL</em> ä¸­æ‰€è°ˆåˆ°çš„ç”Ÿæˆå¯¹ç§°å¯†é’¥çš„è¿‡ç¨‹é¢</p>
<p><em>Google</em> æœç´¢åå‘ç°åœ¨<a target="_blank" rel="noopener" href="https://www.silverf0x00.com/tls-extended-master-secret-breaking-ssl-proxies/">TLS Extended Master Secret, Breaking SSL Proxies</a>æåˆ°äº†</p>
<blockquote>
<p>Before extended master secret extension was introduced, parties communicating under TLS protocol (RFC 5246) would compute master secret with the following formula:<br>master_secret = PRF(pre_master_secret, â€œmaster secretâ€,<br>ã€€ClientHello.random + ServerHello.random)<br>ã€€[0..47];</p>
</blockquote>
<p>åœ¨<a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc5246">RFC 5246</a> ä¸­ <em>Master secret</em> ç¡®å®æ˜¯ä½¿ç”¨ <em>pre master secret</em> + <em>ClientHello.random</em> + <em>ServerHello.random</em> è®¡ç®—ç”Ÿæˆçš„ï¼Œä½†æ˜¯åœ¨ <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc7627#section-1">RFC 7627</a>ä¸­æè¿°äº†ä¸€ç§æ”»å‡»ã€‚</p>
<blockquote>
<ol>
<li> C sends a â€œClientHelloâ€ to A, and A forwards it to S.</li>
<li> S sends a â€œServerHelloâ€ to A, and A forwards it to C.</li>
<li>S sends a â€œCertificateâ€, containing its certificate chain, to A.<pre><code>A replaces it with its own certificate chain and sends it to C.
</code></pre>
</li>
<li> S sends a â€œServerHelloDoneâ€ to A, and A forwards it to C.</li>
<li>C sends a â€œClientKeyExchangeâ€ to A, containing the<pre><code>&quot;pre_master_secret&quot;, encrypted with A&#39;s public key.  A decrypts
the &quot;pre_master_secret&quot;, re-encrypts it with S&#39;s public key, and
sends it on to S.
</code></pre>
</li>
<li>C sends a â€œFinishedâ€ to A.  A computes a â€œFinishedâ€ for its<pre><code>connection with S and sends it to S.
</code></pre>
</li>
<li>S sends a â€œFinishedâ€ to A.  A computes a â€œFinishedâ€ for its<pre><code>connection with C and sends it to C.
</code></pre>
</li>
</ol>
</blockquote>
<p>è¢«æ”»å‡»çš„ä¸»è¦åŸå› æ˜¯ <em>Master Secret</em> åªä¾èµ–äº <em>ClientHello.random</em> , <em>ServerHello.random</em> ,è§£å†³æ–¹æ¡ˆæ˜¯æŠŠè¯ä¹¦å’Œä¼šè¯çš„ä¿¡æ¯éƒ½å‚ä¸åˆ° <em>Master Secret</em> çš„ç”Ÿæˆè¿‡ç¨‹</p>
<p>æ‰©å±•ç±»å‹ä¸º0x0017çš„æ‰©å±•ä¸»å¯†é’¥å‘å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨é€šçŸ¥ä½¿ç”¨ä»¥ä¸‹å…¬å¼ç”Ÿæˆä¸»å¯†é’¥ï¼š</p>
<blockquote>
<p>master_secret = PRF(pre_master_secret, â€œextended master secretâ€,<br>ã€€ã€€session_hash)<br>ã€€ã€€[0..47];</p>
</blockquote>
<p>é€šè¿‡æ€»ç»“ä¸å®è·µå°è¯•ï¼Œæˆ‘å¯¹ <em>HTTPS</em> åè®®çš„è®¤è¯†åˆæ·±åˆ»äº†ä¸€ç‚¹</p>
<p><em>Thatâ€™s all</em></p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/HTTPS">wiki - HTTPS</a></li>
<li><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Transport_Layer_Security">wiki - TLS</a></li>
<li><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/zh-hans/%E5%8A%A0%E5%AF%86">wiki - åŠ å¯†</a></li>
<li><a target="_blank" rel="noopener" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa380513(v=vs.85).aspx">TLS Handshake Protocol</a></li>
<li><a target="_blank" rel="noopener" href="https://ldapwiki.com/wiki/Premaster%20Secret">Premaster Secret</a></li>
<li><a target="_blank" rel="noopener" href="https://www.ietf.org/rfc/rfc2246.txt">RFC 2246 - The TLS Protocol Version 1.0 </a></li>
<li><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Certificate_authority">Certificate authority</a></li>
<li><a target="_blank" rel="noopener" href="https://www.silverf0x00.com/tls-extended-master-secret-breaking-ssl-proxies/">TLS Extended Master Secret, Breaking SSL Proxies</a></li>
<li><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack">Man-in-the-middle attack</a></li>
</ul>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2017/03/18/iOSer-Realize-3d-Touch-on-iOS/" rel="prev" title="iOS - å®ç° 3D Touch åŠŸèƒ½">
      <i class="fa fa-chevron-left"></i> iOS - å®ç° 3D Touch åŠŸèƒ½
    </a></div>
      <div class="post-nav-item">
    <a href="/2017/03/26/iOSer-Understand-the-block-next/" rel="next" title="iOS - ç†è§£Block(ä¸‹)">
      iOS - ç†è§£Block(ä¸‹) <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89"><span class="nav-number">1.</span> <span class="nav-text">å®šä¹‰</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86-amp-%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86"><span class="nav-number">2.</span> <span class="nav-text">å¯¹ç§°åŠ å¯† &amp; éå¯¹ç§°åŠ å¯†</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="nav-number">2.1.</span> <span class="nav-text">ä¼˜ç¼ºç‚¹</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%9A%84%E7%94%A8%E9%80%94"><span class="nav-number">3.</span> <span class="nav-text">éå¯¹ç§°åŠ å¯†çš„ç”¨é€”</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SSL-%E6%8F%A1%E6%89%8B%E6%B5%81%E7%A8%8B"><span class="nav-number">4.</span> <span class="nav-text">SSL æ¡æ‰‹æµç¨‹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%8F%E5%95%86%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95"><span class="nav-number">4.1.</span> <span class="nav-text">åå•†åŠ å¯†ç®—æ³•</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%A4%E6%8D%A2%E8%AF%81%E4%B9%A6"><span class="nav-number">4.2.</span> <span class="nav-text">äº¤æ¢è¯ä¹¦</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E5%AF%86%E9%92%A5"><span class="nav-number">4.3.</span> <span class="nav-text">ç”Ÿæˆå¯¹ç§°åŠ å¯†å¯†é’¥</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6"><span class="nav-number">5.</span> <span class="nav-text">æ•°å­—è¯ä¹¦</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89-1"><span class="nav-number">5.1.</span> <span class="nav-text">å®šä¹‰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%97%E5%AD%90"><span class="nav-number">5.2.</span> <span class="nav-text">æ —å­</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CA"><span class="nav-number">5.3.</span> <span class="nav-text">CA</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#csr-Certificate-Signing-request"><span class="nav-number">5.4.</span> <span class="nav-text">csr (Certificate Signing request)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">5.5.</span> <span class="nav-text">æ€»ç»“</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E8%B7%B5"><span class="nav-number">6.</span> <span class="nav-text">å®è·µ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E8%B7%B5-Client-Hello"><span class="nav-number">6.1.</span> <span class="nav-text">[å®è·µ]Client Hello</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E8%B7%B5-Server-Hello"><span class="nav-number">6.2.</span> <span class="nav-text">[å®è·µ]Server Hello</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E8%B7%B5-%E8%AF%81%E4%B9%A6%E4%BA%A4%E6%8D%A2"><span class="nav-number">6.3.</span> <span class="nav-text">[å®è·µ]è¯ä¹¦äº¤æ¢</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E8%B7%B5-%E7%94%9F%E6%88%90%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E5%AF%86%E9%92%A5"><span class="nav-number">6.4.</span> <span class="nav-text">[å®è·µ]ç”Ÿæˆå¯¹ç§°åŠ å¯†å¯†é’¥</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83"><span class="nav-number">7.</span> <span class="nav-text">å‚è€ƒ</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">å¿˜å·ä¸‰</p>
  <div class="site-description" itemprop="description">404~ ~ ~å°±å¤šèµ°ä¸€æ­¥</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">82</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">26</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">å¿˜å·ä¸‰</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> å¼ºåŠ›é©±åŠ¨
  </div>


        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
